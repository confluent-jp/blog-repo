<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Kafka Core | Confluent Japan Community</title><link>https://confluent-jp.github.io/community/category/kafka-core/</link><atom:link href="https://confluent-jp.github.io/community/category/kafka-core/index.xml" rel="self" type="application/rss+xml"/><description>Kafka Core</description><generator>Wowchemy (https://wowchemy.com)</generator><language>ja-jp</language><lastBuildDate>Mon, 21 Aug 2023 00:00:00 +0000</lastBuildDate><image><url>https://confluent-jp.github.io/community/media/icon_hubade5daff97c80353b10ab16b141ee15_5385_512x512_fill_lanczos_center_3.png</url><title>Kafka Core</title><link>https://confluent-jp.github.io/community/category/kafka-core/</link></image><item><title>è§£å‰– Kafka Controller Broker</title><link>https://confluent-jp.github.io/community/blog/kafka-controller-broker-explained/</link><pubDate>Mon, 21 Aug 2023 00:00:00 +0000</pubDate><guid>https://confluent-jp.github.io/community/blog/kafka-controller-broker-explained/</guid><description>&lt;blockquote>
&lt;p>ã“ã®ãƒ–ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªã¯Kafkaã‚³ãƒŸãƒƒã‚¿ã§ã‚ã‚‹ Stanislav Kozlovski(&lt;a href="https://https://twitter.com/BdKozlovski" target="_blank" rel="noopener">ğ•&lt;/a>|&lt;a href="https://www.linkedin.com/in/stanislavkozlovski/" target="_blank" rel="noopener">Ln&lt;/a>) ã®ã‚µã‚¤ãƒˆã§2018/10/31ã«å…¬é–‹ã•ã‚ŒãŸ&lt;a href="https://stanislavkozlovski.medium.com/apache-kafkas-distributed-system-firefighter-the-controller-broker-1afca1eae302" target="_blank" rel="noopener">Apache Kafkaâ€™s Distributed System Firefighter â€” The Controller Broker&lt;/a>ã®æ—¥æœ¬èªè¨³ã§ã™ã€‚Stanislavæœ¬äººã®äº†æ‰¿ã‚’å¾—ã¦ç¿»è¨³/å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«&lt;/h2>
&lt;p>Kafkaã¯æˆé•·ã‚’ç¶šã‘ã‚‹åˆ†æ•£ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°åŸºç›¤ã§ã™ã€‚ç¾æ™‚ç‚¹ã§ã®æ¥­ç•Œãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆæŠ€è¡“ã§ã‚ã‚Šã€åºƒãŒã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®åˆ©ç”¨ã«å¯¾ã—ã¦ã‚‚æ‹¡å¼µã—ã¤ã¤å®‰å®šçš„ã«ç¨¼åƒã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ã‚‚ã—Kafkaã®æ¦‚è¦ã«ã¤ã„ã¦ã‚‚ã†å°‘ã—çŸ¥ã‚ŠãŸã„æ–¹ã¯&lt;a href="https://hackernoon.com/thorough-introduction-to-apache-kafka-6fbf2989bbc1" target="_blank" rel="noopener">A Thorough Introduction To Apache Kafka&lt;/a>ã‚’ã”è¦§ãã ã•ã„ã€‚&lt;/p>
&lt;p>ã“ã®è¨˜äº‹ã‚’æ›¸ãä¸­ã§ã€ã“ã®Kafkaã®å®‰å®šç¨¼åƒã‚’æ”¯ãˆã‚‹ä¸­ã®ä»•çµ„ã¿ã«ã¤ã„ã¦æ›¸ããŸã„ã¨æ€ã†ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p>
&lt;p>ã“ã®ã‚¨ãƒ³ãƒˆãƒªã§ã¯Kafkaã«ãŠã‘ã‚‹Controllerã®æ¦‚å¿µ - Kafkaã¨ã„ã†åˆ†æ•£åŸºç›¤ã‚’å¥åº·çš„ã«ç¨¼åƒã—ç¶šã‘ã‚‹ä½¿å‘½ã‚’æ”¯ãˆã‚‹æ©Ÿèƒ½ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚&lt;/p>
&lt;h2 id="controller-broker">Controller Broker&lt;/h2>
&lt;p>åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã¯å¸¸ã«å”èª¿ã®ä¸­ã§ç¨¼åƒã—ç¶šã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä½•ã‹ã—ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚¯ãƒ©ã‚¹ã‚¿ã§ç™ºç”Ÿã—ãŸå ´åˆã€ã‚¯ãƒ©ã‚¹ã‚¿å†…ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯åŒèª¿ã—ã¦ãã‚Œã«åå¿œã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚ãã®ä¸­ã§ã€ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã—ã¦ã©ã†åå¿œã™ã‚‹ã¹ããªã®ã‹ã€Brokerã¯ä½•ã‚’ã™ã¹ããªã®ã‹ã‚’æŒ‡ç¤ºã™ã‚‹å­˜åœ¨ãŒå¿…è¦ã§ã™ã€‚&lt;/p>
&lt;p>ãã®å½¹å‰²ã‚’æ‹…ã†ã®ãŒControllerã§ã™ã€‚
Controllerè‡ªèº«ã¯è¤‡é›‘ãªä»•çµ„ã¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ - Controllerã‚‚Brokerã§ã‚ã‚Šã€é€šå¸¸ã®Brokerã¨ã—ã¦ã®å½¹å‰²ã¨åˆã‚ã›ã¦è¿½åŠ ã®å½¹å‰²ã‚‚æŒã¤Brokerã§ã™ã€‚ã¤ã¾ã‚ŠController Brokerã‚‚Partitionã‚’åˆ¶å¾¡ã—ã€Readã¨Writeã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾å¿œã—ã€è£ã§ã¯ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã—ã¾ã™ã€‚&lt;/p>
&lt;p>ä»Šè¿½åŠ ã®å½¹å‰²ã®ä¸­ã§æœ€ã‚‚é‡è¦ãªã®ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¿å†…ã®Brokerãƒãƒ¼ãƒ‰ã®ç®¡ç†ã§ã‚ã‚Šã€BrokerãŒè¿½åŠ ã€ã‚¯ãƒ©ã‚¹ã‚¿ã‹ã‚‰é›¢è„±ã€ã‚‚ã—ãã¯éšœå®³ãŒç™ºç”Ÿã—ãŸéš›ã«é©åˆ‡ã«ãã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã¯Partitionã®ãƒªãƒãƒ©ãƒ³ã‚¹ã‚„æ–°ãŸãªPartion Leaderã®ç‰¹å®šã‚‚å«ã¾ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>Kafkaã‚¯ãƒ©ã‚¹ã‚¿ã«ã¯ControllerãŒå¸¸ã«ç¨¼åƒã—ã€å”¯ä¸€1ã¤ã®Controllerã®ã¿ç¨¼åƒã—ã¾ã™ã€‚&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/p>
&lt;h2 id="controllerã®å½¹å‰²">Controllerã®å½¹å‰²&lt;/h2>
&lt;p>Controller Brokerã¯è¤‡æ•°ã®è¤‡æ•°ã‚’æ‹…ã„ã¾ã™ã€‚Topicã®ä½œæˆ/å‰Šé™¤ã€Partitionã®è¿½åŠ  (ã¨Leaderã®ç‰¹å®š)ã€BrokerãŒClusterã‚’é›¢è„±ã—ãŸéš›ã®è«¸ã€…ã®åˆ¶å¾¡ç­‰æ§˜ã€…ã‚ã‚Šã¾ã™ãŒã€åŸºæœ¬çš„ã«ã¯ã‚¯ãƒ©ã‚¹ã‚¿ã«ãŠã‘ã‚‹ç®¡ç†è€…ã¨ã—ã¦æŒ¯ã‚‹èˆã„ã¾ã™ã€‚&lt;/p>
&lt;h3 id="brokerãƒãƒ¼ãƒ‰ã®é›¢è„±">Brokerãƒãƒ¼ãƒ‰ã®é›¢è„±&lt;/h3>
&lt;p>ã‚¨ãƒ©ãƒ¼ã‚„è¨ˆç”»çš„ãªåœæ­¢ã«ã‚ˆã£ã¦Brokerãƒãƒ¼ãƒ‰ãŒã‚¯ãƒ©ã‚¹ã‚¿ã‹ã‚‰é›¢è„±ã—ãŸéš›ã€ãã®Brokerãƒãƒ¼ãƒ‰ã«Leaderã®ã‚ã£ãŸPartitionã«ã¯ã‚¢ã‚¯ã‚»ã‚¹å‡ºæ¥ãªããªã‚Šã¾ã™ã€‚ (ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯Write/Readã®ã„ãšã‚Œã§ã‚ã£ã¦ã‚‚å¸¸ã«Partition Leaderã«ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>) ã“ã®ç‚ºBrokeré›¢è„±æ™‚ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’çŸ­ç¸®ã™ã‚‹ã«ã¯ã€ã„ã‹ã«è¿…é€Ÿã«æ–°ãŸãªLeaderã‚’é¸å‡ºã™ã‚‹ã‹ãŒé‡è¦ã«ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>Controller Brokerã¯ä»–ã®Brokerãƒãƒ¼ãƒ‰ãŒé›¢è„±ã—ãŸéš›ã«å¯¾å‡¦ã—ã¾ã™ã€‚Zookeeperã«ã¯&lt;a href="https://zookeeper.apache.org/doc/r3.4.8/zookeeperProgrammers.html#ch_zkWatches" target="_blank" rel="noopener">Zookeeper Watch&lt;/a>ã¨å‘¼ã°ã‚Œã‚‹ç‰¹å®šãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´æ™‚ã«ç™»éŒ²è€…ã«å¯¾ã—ã¦é€šçŸ¥ã‚’ã™ã‚‹æ©Ÿèƒ½ã§ã€Controllerã¯ã“ã®Zookeeper Watchã‚’åˆ©ç”¨ã—ã¦Brokerã®é›¢è„±ã‚’æ¤œçŸ¥ã—ã¾ã™ã€‚Zookeeper Watchã¯Brokeré›¢è„±æ™‚ã®ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦åƒãKafkaã«ã¨ã£ã¦éå¸¸ã«é‡è¦ãªæ©Ÿèƒ½ã§ã™ã€‚&lt;/p>
&lt;p>ã“ã“ã«ãŠã‘ã‚‹ã€Œç‰¹å®šãƒ‡ãƒ¼ã‚¿ã€ã¨ã¯Brokerãƒ‡ãƒ¼ã‚¿ã®é›†åˆã§ã™ã€‚&lt;/p>
&lt;p>ä¸‹ã«ã‚ã‚‹ã®ã¯Broker 2ã®&lt;a href="https://zookeeper.apache.org/doc/r3.4.8/zookeeperProgrammers.html#ch_zkSessions" target="_blank" rel="noopener">Zookeeper Session&lt;/a>ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹äº‹ã«ã‚ˆã‚ŠBroker 2ã®IDãŒãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤ã•ã‚ŒãŸå ´åˆã®å›³è§£ã§ã™ã€‚(Kafka Brokerã¯Zookeeperã¸ã®ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆã‚’é€ã‚Šç¶šã‘ã‚‹ãŒã€é…ã‚Œãªããªã‚‹ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç„¡åŠ¹åŒ–ã™ã‚‹)&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Zookeeper Watch and Controller" srcset="
/community/media/blogs/kafka-controller-broker-explained/zookeeper-watch_hu999b6f38219025080af213f7c0820560_78754_933d8c0d0ca12b3944bf46cc705eee83.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/zookeeper-watch_hu999b6f38219025080af213f7c0820560_78754_55f25aaf2122bf1cb5ca633f5a0880a6.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/zookeeper-watch_hu999b6f38219025080af213f7c0820560_78754_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/zookeeper-watch_hu999b6f38219025080af213f7c0820560_78754_933d8c0d0ca12b3944bf46cc705eee83.webp"
width="760"
height="637"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Controllerã¯ã“ã®Brokeré›¢è„±ã®é€šçŸ¥ã‚’å—ã‘å–ã‚Šä½œæ¥­ã«å–ã‚Šæ›ã‹ã‚Šã¾ã™ãŒã€ã¾ãšã¯Brokerã®é›¢è„±ã«ã‚ˆã£ã¦å½±éŸ¿ã‚’å—ã‘ãŸPartitionã®æ–°ãŸãªLeaderã‚’æ±ºå®šã—ã¾ã™ã€‚ã“ã®å¾Œã€ã‚¯ãƒ©ã‚¹ã‚¿å†…ã®å…¨ã¦ã®Brokerã«å¯¾ã—ã¦é€šçŸ¥ã—ã€ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã£ãŸå„Partitionæ¯ã«Leaderã«ãªã£ãŸã‚ŠFollowerã¨ã—ã¦Leaderã«&lt;a href="https://kafka.apache.org/protocol#The_Messages_LeaderAndIsr" target="_blank" rel="noopener">LeaderAndIsr&lt;/a>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä»˜ã—ã¾ã™ã€‚&lt;/p>
&lt;h3 id="brokerãƒãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹ã‚¿å¾©å¸°">Brokerãƒãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹ã‚¿å¾©å¸°&lt;/h3>
&lt;p>é©åˆ‡ãªPartition Leaderã®é…ç½®ã¯Kafkaã‚¯ãƒ©ã‚¹ã‚¿ã®è² è·åˆ†æ•£ã®ä¸Šã§é‡è¦ãªè¦ç´ ã§ã™ã€‚ä¸Šè¨˜ã§èª¬æ˜ã—ãŸã¨ãŠã‚Šã€Brokerãƒãƒ¼ãƒ‰ãŒã‚¯ãƒ©ã‚¹ã‚¿ã‚’é›¢è„±ã—ãŸéš›ã«ã¯ä»–ã®BrokerãŒä»£ã‚ã£ã¦å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å ´åˆBrokerã¯å½“åˆã®æƒ³å®šä»¥ä¸Šã®Partitionã‚’å„ã€…ãŒæ‹…ã†ã“ã¨ã«ãªã‚Šã€ã‚¯ãƒ©ã‚¹ã‚¿å…¨ä½“ã®å¥å…¨æ€§ã‚„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å°‘ãªã‹ã‚‰ãšå½±éŸ¿ã‚’åŠã¼ã—ã¾ã™ã€‚å½“ç„¶ãªã‚‹ã¹ãæ—©ããƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚Šæˆ»ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>Kafkaã¯å…ƒã€…ã®Partitionã‚¢ã‚µã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãŒã€ã‚ã‚‹ç¨‹åº¦ã€Œé©åˆ‡ã€ã§ã‚ã‚‹ã¨ã„ã†æƒ³å®šã‚’æŒã£ã¦ã„ã¾ã™ã€‚ã“ã®ã‚¢ã‚µã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã«ãŠã‘ã‚‹Partition Leaderã¯ã„ã‚ã‚†ã‚‹ &lt;em>Preferreed Leader(å„ªå…ˆãƒªãƒ¼ãƒ€ãƒ¼)&lt;/em> ã¨ã—ã¦èªè­˜ã•ã‚Œã€æœ€åˆã«ãã®PartitionãŒè¿½åŠ ã•ã‚ŒãŸæ™‚ã®Partition Leaderã‚’æŒ‡ã—ã¾ã™ã€‚åˆã‚ã›ã¦Kafkaã¯&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-36&amp;#43;Rack&amp;#43;aware&amp;#43;replica&amp;#43;assignment" target="_blank" rel="noopener">ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆã¨ã—ã¦ã®ãƒ©ãƒƒã‚¯ã‚„Availability Zoneã‚’æ„è­˜ã—ãŸPartitioné…ç½®ã®æ©Ÿèƒ½&lt;/a> (ãƒ©ãƒƒã‚¯/AZéšœå®³è€æ€§ã‚’ç¢ºä¿ã™ã‚‹ç‚ºã«Leaderã¨Followerã‚’åˆ¥ã®ãƒ©ãƒƒã‚¯/AZã«é…ç½®ã™ã‚‹) ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€Partition Leaderã®é…ç½®ã¯ã‚¯ãƒ©ã‚¹ã‚¿ã®ä¿¡é ¼æ€§ã«å¤§ããå¯„ä¸ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯&lt;code>auto.leader.rebalance.enabled=true&lt;/code>ã¨ãªã£ã¦ãŠã‚Šã€Kafkaã¯Preferred LeaderãŒå­˜åœ¨ã—ã€ã‹ã¤å®Ÿéš›ã®Partition Leaderã§ã¯ãªã„å ´åˆã«ã¯Preferred Leaderã‚’å†é¸å‡ºã—ã¾ã™ã€‚&lt;/p>
&lt;p>Brokerãƒãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹ã‚¿ã‹ã‚‰ã®é›¢è„±ã‚‚ã€å¤šãã®å ´åˆä¸€æ™‚çš„ã§ã‚ã‚Šã€ã‚ã‚‹ä¸€å®šæ™‚é–“çµŒéå¾Œã«é›¢è„±ã—ãŸBrokerãƒãƒ¼ãƒ‰ã¯å†åº¦ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦å¾©å¸°ã—ã¾ã™ã€‚ã“ã®ç‚ºBrokerãƒãƒ¼ãƒ‰ãŒé›¢è„±ã—ãŸéš›ã«ã‚‚é–¢é€£ã™ã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯å³åº§ã«å‰Šé™¤ã•ã‚Œãšã€Follower Partitionã‚‚æ–°ãŸã«ã‚¢ã‚µã‚¤ãƒ³ã•ã‚Œã¾ã›ã‚“ã€‚&lt;/p>
&lt;p>æ³¨æ„ç‚¹ã¨ã—ã¦ã€å†å‚åŠ ã—ãŸBrokerãƒãƒ¼ãƒ‰ã‚‚ç›´ãã«Partition Leaderã¨ã—ã¦å†é¸å‡ºã•ã‚Œã‚‹è¨³ã§ã¯ãªãã€ãã®å€™è£œã¨ãªã‚‹ç‚ºã«ã¯åˆ¥ã®æ¡ä»¶ã‚‚å¿…è¦ã¨ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;h3 id="in-sync-replicas">In-Sync Replicas&lt;/h3>
&lt;p>In-Sync Replica (ISR) ã¯çŠ¶æ…‹ãŒPartition Leaderã¨åŒã˜ Followerã‚’æŒ‡ã—ã¾ã™ã€‚è¨€ã„æ–¹ã‚’å¤‰ãˆã‚‹ã¨ã€ISRã¯ãã®Leaderã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¿½ã„ã¤ã„ã¦ã„ã‚‹çŠ¶æ…‹ã«ã‚ã‚Šã¾ã™ã€‚Partion Leaderã¯ã©ã®FollowerãŒISRã§ã©ã®FollowerãŒãã†ã§ã¯ãªã„ã‹ã‚’ãƒˆãƒ©ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãã®çŠ¶æ…‹ã¯Zookeeperã«æ°¸ç¶šåŒ–ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>Kafkaã®éšœå®³è€æ€§ã¨å¯ç”¨æ€§ã®ä¿è¨¼ã¯ãƒ‡ãƒ¼ã‚¿ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åŸºã¥ã„ã¦ãŠã‚Šã€kafkaãŒæ©Ÿèƒ½ã™ã‚‹ã«ã¯å¸¸ã«ååˆ†ãªISRãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹ã‹ãŒæ¥µã‚ã¦é‡è¦ã§ã™ã€‚&lt;/p>
&lt;p>FollowerãŒLeaderã«æ˜‡æ ¼ã™ã‚‹ã«ã¯ã¾ãšISRã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å…¨ã¦ã®Partitionã«ã¯ISRã®ãƒªã‚¹ãƒˆãŒã‚ã‚Šã€Partition Leaderã¨Controllerã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¦ã„ã¾ã™ã€‚ISRã‹ã‚‰æ–°ãŸãªPartition Leaderã‚’é¸å‡ºã™ã‚‹å‡¦ç†ã¯ &lt;em>Clean Leader Election&lt;/em> ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚ä¸€æ–¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã“ã‚Œã¨ã¯ç•°ãªã‚‹æ–¹æ³•ã§Leaderã‚’æ˜‡æ ¼ã•ã›ã‚‹äº‹ã‚‚å¯èƒ½ã§ã€Partion LeaderãŒã‚¯ãƒ©ã‚¹ã‚¿ã‚’é›¢è„±ã—ãŸéš›ã«ã¯ISRã§ã¯ãªã„Followerã‚’æ˜‡æ ¼ã•ã›ã‚‹äº‹ã‚‚å¯èƒ½ã§ã™ã€‚ã“ã‚Œã¯Leaderã‚‚ISRã‚‚å­˜åœ¨ã—ãªã„ã¨ã„ã†çŠ¶æ³ã«ãŠã„ã¦ã€ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã‚ˆã‚Šå¯ç”¨æ€§ã‚’å„ªå…ˆã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ç¨€ãªã‚±ãƒ¼ã‚¹ã§ã™ã€‚&lt;/p>
&lt;p>ã“ã“ã§å†åº¦ã®ç¢ºèªã«ãªã‚Šã¾ã™ãŒã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯Partition Leaderã‹ã‚‰ã—ã‹Consumeã§ãã¾ã›ã‚“ã€‚ä»®ã«ISRã§ã¯ãªã„Followerã‚’Leaderã«æ˜‡æ ¼ã—ãŸå ´åˆã«ã¯ã€å½“ç„¶ã¾ã Leaderã‹ã‚‰å–å¾—ã•ã‚Œã¦ã„ãªã‹ã£ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å¤±ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤±ã†ã ã‘ã§ãªãã€Consumerã‹ã‚‰è¦‹ãŸã‚¤ãƒ™ãƒ³ãƒˆã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ä¸Šã®ä½ç½® (ã‚ªãƒ•ã‚»ãƒƒãƒˆ) ã‚‚ä¸Šæ›¸ã‹ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>æ®‹å¿µãªãŒã‚‰Clearn Leader Electionã®å ´åˆã«ã‚‚åŒæ§˜ã®ãƒ‡ãƒ¼ã‚¿éšœå®³ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ã¯ã‚ã‚Šã¾ã™ã€‚ISRã‚‚æ§˜ã€…ãªè¦å› ã«ã‚ˆã£ã¦Leaderã¨å®Œå…¨ã«åŒæœŸãŒå–ã‚Œã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã§ã™ - å…·ä½“çš„ã«ã¯ã€Leaderã®ã‚ªãƒ•ã‚»ãƒƒãƒˆãŒ100ã¨ã—ãŸæ™‚ã«ã€Followerã®ã‚ªãƒ•ã‚»ãƒƒãƒˆãŒ95ã€99ã€80ã¨ãªã£ã¦ã„ã‚‹ã‚ˆã†ãªçŠ¶æ³ã§ã™ã€‚ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯éåŒæœŸã«å®Ÿæ–½ã•ã‚Œã‚‹ç‚ºã€æœ€å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¾ã§å®Œå…¨ã«Followerå´ã«æ¸¡ã£ãŸã¨ä¿è¨¼ã™ã‚‹äº‹ã¯å›°é›£ã§ã™ã€‚&lt;/p>
&lt;p>FollowerãŒLeaderã«å¯¾ã—ã¦in-syncã§ã‚ã‚‹ã¨åˆ¤æ–­ã™ã‚‹æ¡ä»¶ã¯ä»¥ä¸‹ã§ã™ï¼š&lt;/p>
&lt;ul>
&lt;li>Partition Leaderã‹ã‚‰æœ€æ–°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ &lt;em>X&lt;/em> ãƒŸãƒªç§’å‰ã«å–å¾—ã—ã¦ã„ã‚‹ã€‚ (Xã¯ &lt;code>replica.lag.time.max.ms&lt;/code>ã«ã¦è¨­å®šå¯èƒ½)&lt;/li>
&lt;li>Zookeeperã«å¯¾ã—ã¦ &lt;em>Y&lt;/em> ãƒŸãƒªç§’å‰ã«ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆã‚’é€ã£ã¦ã„ã‚‹ã€‚ (Yã¯&lt;code>zookeeper.session.timeout.ms&lt;/code>ã«ã¦è¨­å®šå¯èƒ½)&lt;/li>
&lt;/ul>
&lt;h3 id="ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã¨è€ä¹…æ€§">ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã¨è€ä¹…æ€§&lt;/h3>
&lt;p>LeaderãŒæ©Ÿèƒ½ä¸å…¨ã«é™¥ã£ãŸå ´åˆã€çŠ¶æ³ã«ã‚ˆã£ã¦ã¯ISRãŒæ–°ã—ã„Leaderã«æ˜‡æ ¼ã—ãŸå ´åˆã«ã‚‚åƒ…ã‹ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤±ã†å¯èƒ½æ€§ãŒã‚ã‚‹ç‚¹ã«ã¤ã„ã¦è¨€åŠã—ã¾ã—ãŸã€‚å…·ä½“çš„ã«ã¯LeaderãŒFollowerã‹ã‚‰ã®ãƒ•ã‚§ãƒƒãƒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã—çµ‚ã‚ã£ãŸç›´å¾Œã«æ–°ãŸã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã£ãŸã‚±ãƒ¼ã‚¹ã§ã€ã“ã®å ´åˆæ–°ãŸãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã¾ã FollowerãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åˆ°ç€ã‚’æŠŠæ¡ã™ã‚‹ã¾ã§ã®ç©ºç™½æœŸé–“ãŒå­˜åœ¨ã—å¾—ã¾ã™ã€‚ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§LeaderãŒæ©Ÿèƒ½ä¸å…¨ã«é™¥ã£ãŸå ´åˆã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯Leaderã«ã—ã‹å­˜åœ¨ã—ãªã„ãªãŒã‚‰ã‚‚Followerã®ä¸€éƒ¨ã¯ISRã¨ã—ã¦æˆç«‹ã—ã¾ã™ã€‚ãã—ã¦ISRãŒãã®ã¾ã¾Leaderã«æ˜‡æ ¼ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="ISR which is really not in-sync sequence" srcset="
/community/media/blogs/kafka-controller-broker-explained/not-in-sync-isr_hu7f8f7a0d1dc18ad510097bfa7ae71f61_47308_adb7d173994b97446bf22bea411ccfcb.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/not-in-sync-isr_hu7f8f7a0d1dc18ad510097bfa7ae71f61_47308_df314272b8d2415dfd6f7a900a96e469.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/not-in-sync-isr_hu7f8f7a0d1dc18ad510097bfa7ae71f61_47308_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/not-in-sync-isr_hu7f8f7a0d1dc18ad510097bfa7ae71f61_47308_adb7d173994b97446bf22bea411ccfcb.webp"
width="760"
height="617"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="produerå´ã®acksã®è¨­å®š">Produerå´ã®Acksã®è¨­å®š&lt;/h3>
&lt;p>ä¸Šè¨˜ã®ä¾‹ã§ã¯Leaderã¯è‡ªèº«ã¸ã®æ›¸ãè¾¼ã¿ãŒå®Œäº†ã—ãŸæ™‚ç‚¹ã§Acksã‚’è¿”ã™è¨­å®š (&lt;code>acks=1&lt;/code>) ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚Broker 1ãŒæœ€å¾Œã®Acksã‚’è¿”ã—ãŸç›´å¾Œã«æ©Ÿèƒ½ä¸å…¨ã¨ãªã£ãŸç‚ºã€Broker 2ã¯ISRã§ã¯ã‚ã‚‹ã‚‚ã®ã®&lt;code>offset:100&lt;/code>ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å—ã‘å–ã£ã¦ã„ãªã„çŠ¶æ…‹ã§Leaderã«æ˜‡æ ¼ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ã“ã®äº‹è±¡ã¯&lt;code>acks=all&lt;/code>ã¨è¨­å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šå›é¿ã™ã‚‹äº‹ã¯å¯èƒ½ã§ã€ã¤ã¾ã‚ŠLeaderã¯å…¨ã¦ã®ISRã¸ã®æ›¸ãè¾¼ã¿ãŒæ­£å¸¸çµ‚äº†ã—ãŸæ™‚ç‚¹ã§åˆã‚ã¦acksã‚’è¿”ã—ã¾ã™ã€‚æ®‹å¿µãªãŒã‚‰ã“ã®è¨­å®šã®å ´åˆã‚¯ãƒ©ã‚¹ã‚¿å…¨ä½“ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«ã¯å½±éŸ¿ã—ã¾ã™ã€‚Kafkaã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯pullãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ç‚ºã€Leaderã¯å…¨ã¦ã®ISRã®ãƒ•ã‚§ãƒƒãƒãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå±Šãã€ã¾ãŸãã‚ŒãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…ãŸãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚&lt;/p>
&lt;p>ã„ãã¤ã‹ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å„ªå…ˆã—ã¦&lt;code>acks=1&lt;/code>ã¨ã™ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>&lt;code>acks=all&lt;/code>ã¨è¨­å®šã—ãŸå ´åˆã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ¬ æã¯å›é¿å‡ºæ¥ã¾ã™ã€‚æ–°ãŸã«Leaderã¨ãªã£ãŸISRã«ã¯ç„¡ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ—¢ã«å–å¾—ã—ãŸConsumerãŒå‡ºã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚Producerã‹ã‚‰ã®acksã‚’å…ƒã«ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã¯ä¿ãŸã‚Œã¾ã™ã€‚&lt;/p>
&lt;h3 id="high-watermark-offset">High Watermark Offset&lt;/h3>
&lt;p>Leaderã¯å…¨ã¦ã®ISRã¸ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Œäº†ã—ãªã„é™ã‚Šacksã‚’è¿”ã•ãªã„ã¨ã—ã¾ã™ã€‚ã“ã®éš›Brokerã¯ &lt;em>high watermark offset&lt;/em> ã¨å‘¼ã°ã‚Œã‚‹ã€Œå…¨ã¦ã®ISRãŒå–å¾—æ¸ˆã¿ã®æœ€å¤§ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã€ã‚’ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚Leaderã¯åˆã‚ã›ã¦Consumerã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦ã“ã®high watermark offsetã‚’è¶…ãˆãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿æä¾›ã™ã‚‹äº‹ã«ã‚ˆã‚Šã€DBã§è¨€ã†ã¨ã“ã‚ã®Non-Repeatabl Readã‚’å›é¿ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="High Watermark Offset" srcset="
/community/media/blogs/kafka-controller-broker-explained/high-watermark-offset_hu7ee940ddd7907971145f7d4d7b70115c_34334_7e9284c01e9197a8bb67bcfaa76768b5.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/high-watermark-offset_hu7ee940ddd7907971145f7d4d7b70115c_34334_b5767dba72b37534de661ef436cf0a84.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/high-watermark-offset_hu7ee940ddd7907971145f7d4d7b70115c_34334_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/high-watermark-offset_hu7ee940ddd7907971145f7d4d7b70115c_34334_7e9284c01e9197a8bb67bcfaa76768b5.webp"
width="760"
height="204"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="split-brain">Split Brain&lt;/h3>
&lt;p>Controller BrokerãŒãƒ€ã‚¦ãƒ³ã—ãŸå ´åˆã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ¬ æã‚’å›é¿ã™ã‚‹ç‚ºã«Kafkaã¯æ€¥é½ä»£ç†ã®Controllerã‚’ç«‹ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>ã“ã“ã§ã®å•é¡Œã¯ã€æˆ‘ã€…ã«ã¯Controller Brokerã®å¿œç­”ä¸èƒ½ãŒå®Œå…¨ãªæ©Ÿèƒ½ä¸å…¨ã«ã‚ˆã‚‹ã‚‚ã®ãªã®ã‹ã€ãã‚Œã¨ã‚‚ä¸€æ™‚çš„ãªéšœå®³ ã«ã‚ˆã‚‹ã‚‚ã®ã‹ã®åˆ¤æ–­ãŒå‡ºæ¥ãªã„äº‹ã§ã™ã€‚ãã‚Œã§ã‚‚æ–°ãŸãªControllerã‚’é¸å‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€å ´åˆã«ã‚ˆã£ã¦ã¯Zombie Controllerã‚’ç”Ÿã¿å‡ºã™å±é™ºæ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚¯ãƒ©ã‚¹ã‚¿ã‹ã‚‰ã¯æ—¢ã«ç¨¼åƒã‚’åœæ­¢ã—Controllerã§ã¯ãªã„ã¨èªè­˜ã•ã‚Œã¦ã„ã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€å†ã³ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã¨ãªã‚ŠControllerã¨ã—ã¦æŒ¯ã‚‹èˆã†Brokerã§ã™ã€‚&lt;/p>
&lt;p>ã“ã®äº‹è±¡ã¯å®¹æ˜“ã«èµ·ã“ã‚Šå¾—ã¾ã™ã€‚ä¾‹ãˆã°ä¸€æ™‚çš„ãª&lt;a href="https://aphyr.com/posts/288-the-network-is-reliable" target="_blank" rel="noopener">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åˆ†æ–­&lt;/a>ãŒç™ºç”Ÿã—ãŸå ´åˆã‚„ã€éå¸¸ã«é•·ã„GC Pause(Stop-the-World - å…¨ã¦ã®å‡¦ç†ãŒGCã®å®Ÿè¡Œå®Œäº†ã¾ã§åœæ­¢ã•ã‚Œã‚‹äº‹è±¡)ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã¯ã€Clusterã¯ãã®Controller BrokerãŒæ—¢ã«åœæ­¢ã—ãŸã¨åˆ¤æ–­ã—å¾—ã¾ã™ã€‚ç‰¹ã«GC Pauseã®å ´åˆã€Controller Brokerã®è¦³ç‚¹ã§ã¯ä½•ä¸€ã¤å¤‰ã‚ã£ã¦ã„ãªã„ã®ã«æ™‚é–“ãŒçµŒéã—ã¦ã„ã‚‹çŠ¶æ³ã¨ãªã‚Šã¾ã™ã€‚ã“ã®ç‚ºã€ControllerãŒæ—¢ã«é¸å‡ºã•ã‚ŒãŸå¾Œã«ä»¥å‰ã®ControllerãŒå¾©å¸°ã™ã‚‹ã€åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹&lt;a href="https://techthoughts.typepad.com/managing_computers/2007/10/split-brain-quo.html" target="_blank" rel="noopener">Split Brain&lt;/a>ãŒç™ºç”Ÿã—ã¾ã™ã€‚&lt;/p>
&lt;p>ä¾‹ã«æº–ãˆã¦è§£èª¬ã—ã¾ã™ã€‚ç¨¼åƒä¸­ã®ControllerãŒé•·ã„GC Pauseã«é™¥ã£ãŸã¨ã—ã¾ã™ã€‚Controllerã®Zookeeper SessionãŒç„¡åŠ¹åŒ–ã•ã‚Œã€&lt;code>/controller&lt;/code>znodeã¯å‰Šé™¤ã•ã‚Œã¾ã™ã€‚ã‚¯ãƒ©ã‚¹ã‚¿å†…ã®ä»–ã®Brokerã¯é€šçŸ¥ã‚’å—ã‘ã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Zombie Controller 1" srcset="
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-1_hu23f36871d72aa03f5abf14da0a4f651a_28874_8234f76cd2ef1f4693fc46419d252975.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-1_hu23f36871d72aa03f5abf14da0a4f651a_28874_ccb5a50a39671ca10d8ef574dba2e1de.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-1_hu23f36871d72aa03f5abf14da0a4f651a_28874_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/zombie-controller-1_hu23f36871d72aa03f5abf14da0a4f651a_28874_8234f76cd2ef1f4693fc46419d252975.webp"
width="760"
height="270"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Controllerã®ä¸åœ¨çŠ¶æ³ã‚’å›é¿ã™ã‚‹ç‚ºã€å…¨ã¦ã®BrokerãŒControllerã«ãªã‚ã†ã¨ã—ã¾ã™ã€‚ã“ã®å ´åˆBroker 2ãŒé¸å‡ºã•ã‚Œæ–°ãŸãªControllerã¨ã—ã¦&lt;code>/controller&lt;/code>znodeã«è‡ªèº«ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>å…¨ã¦ã®Brokerã¯ã“ã®æ–°ãŸãªznodeãŒä½œæˆã•ã‚Œã€Broker 2ãŒControllerã§ã‚ã‚‹é€šçŸ¥ã‚’å—ã‘ã¾ã™ã€‚ã“ã®éš›ã«ã‚‚å”¯ä¸€GC Pauseä¸­ã®Broker 3ã ã‘ã¯ã“ã®é€šçŸ¥ã‚’å—ã‘ã¾ã›ã‚“ã€‚ã¡ãªã¿ã«ã“ã®é€šçŸ¥ãŒBrokerã«åˆ°é”ã—ãªã„å¯èƒ½æ€§ã¯ä»–ã«ã‚‚ã‚ã‚Šã¾ã™ã€‚ã„ãšã‚Œã«ã›ã‚ˆæœ€çµ‚çš„ã«Broker 3ã«ã¯æ–°ãŸãªControlleré¸å‡ºã®é€šçŸ¥ãŒå±Šãã¾ã›ã‚“ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Zombie Controller 2" srcset="
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-2_hu1daff395d8979a57f29a46032a5f58e9_28108_355fbebd342800306f40cf9c793c54b6.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-2_hu1daff395d8979a57f29a46032a5f58e9_28108_303b8045fe641bf13886fe6278809932.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-2_hu1daff395d8979a57f29a46032a5f58e9_28108_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/zombie-controller-2_hu1daff395d8979a57f29a46032a5f58e9_28108_355fbebd342800306f40cf9c793c54b6.webp"
width="760"
height="262"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Broker 3ã§ã®GCå‡¦ç†ãŒå®Œäº†ã—å¾©å¸°ã—ãŸéš›ã€æœªã ã«è‡ªèº«ãŒControllerã ã¨èªè­˜ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Zombie Controller 3" srcset="
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-3_hu69d3de9c1c781c11547d8d4c73b1ae58_22958_9315415f925ce97da7a83dfc91d27d5d.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-3_hu69d3de9c1c781c11547d8d4c73b1ae58_22958_8650d61272f471ed9e32358aaa70c1d0.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/zombie-controller-3_hu69d3de9c1c781c11547d8d4c73b1ae58_22958_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/zombie-controller-3_hu69d3de9c1c781c11547d8d4c73b1ae58_22958_9315415f925ce97da7a83dfc91d27d5d.webp"
width="760"
height="129"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>çµæœã¨ã—ã¦2ã¤ã®ControllerãŒç¨¼åƒçŠ¶æ…‹ã¨ãªã‚Šã€ç•°ãªã‚‹æŒ‡ç¤ºã‚’ä¸¦è¡Œã—ã¦é€ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®çŠ¶æ…‹ã¯ã‚¯ãƒ©ã‚¹ã‚¿ã®çŠ¶æ…‹ã¨ã—ã¦æ¥µã‚ã¦æ‚ªãã€é©åˆ‡ã«å¯¾å¿œã—ãªã‘ã‚Œã°é‡å¤§ãªãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆã‚’èµ·ã“ã—å¾—ã¾ã™ã€‚&lt;/p>
&lt;p>ã‚‚ã—Broker 2(æ–°ãŸã«é¸å‡ºã•ã‚ŒãŸController)ãŒBroker 3ã‹ã‚‰æŒ‡ç¤ºã‚’å—ã‘ãŸå ´åˆã€ã“ã®Broker 3ãŒæ–°ãŸãªControllerã§ã‚ã‚‹ã¨ã„ã†ä¿è¨¼ã¯å–ã‚Œã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿã‚‚ã¡ã‚ã‚“Broker 2ã‚‚åŒæ§˜ã«GC Pauseã«é™¥ã£ãŸå¯èƒ½æ€§ã‚‚ã‚ã‚Šã€è‡ªåˆ†è‡ªèº«ã‚‚æœ€æ–°ã®Controllerã§ã¯ãªã„å¯èƒ½æ€§ã‚‚å¦å®šå‡ºæ¥ã¾ã›ã‚“ã€‚&lt;/p>
&lt;p>ä½•ã‹ã—ã‚‰ã®æ–¹æ³•ã§ã€ã©ã®ControllerãŒæœ€æ–°ã§ã‚ã‚Šç¾åœ¨ç¨¼åƒã™ã¹ãControllerã§ã‚ã‚‹ã®ã‹ã‚’å…¨å“¡ãŒåˆ¤æ–­å‡ºæ¥ã‚‹æ–¹æ³•ãŒå¿…è¦ã§ã™ã€‚&lt;/p>
&lt;p>ãã®æ–¹æ³•ã¯æ¥µã‚ã¦å˜ç´”ã«ã€epoch number&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>ã®åˆ©ç”¨ã«ã‚ˆã‚Šè§£æ±ºã—ã¦ã„ã¾ã™ã€‚epoch numberã¯å˜ç´”ã«1ãšã¤å¢—åŠ ã™ã‚‹è‡ªç„¶æ•°ã§ã‚ã‚Šã€å¤ã„Controllerã®epoch numberãŒ1ã®å ´åˆã€æ–°ãŸã«é¸å‡ºã•ã‚ŒãŸControllerã®epoch numberã¯2ã«ãªã‚Šã¾ã™ã€‚Brokerã¯å˜ç´”ã«ã€æœ€ã‚‚å¤§ããªepoch numberã‚’æŒã¤Controllerã‹ã‚‰ã®æŒ‡ç¤ºã‚’ä¿¡ã˜ã‚‹äº‹ã«ã‚ˆã‚Šsplit brainã‚’å›é¿å‡ºæ¥ã¾ã™ã€‚ã“ã®epoch numberã¯Zookeeperã«ä¿å…¨ã•ã‚Œã¾ã™ã€‚(Zookeeperã®&lt;a href="https://zookeeper.apache.org/doc/current/zookeeperInternals.html#sc_consistency" target="_blank" rel="noopener">Consistency Guarantee&lt;/a>ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚)&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Epoch Number" srcset="
/community/media/blogs/kafka-controller-broker-explained/epoch-number_hu0d56464ab7710eb0c72339108d848be9_45220_60f7d0456161f3cf7749b27aae0caeea.webp 400w,
/community/media/blogs/kafka-controller-broker-explained/epoch-number_hu0d56464ab7710eb0c72339108d848be9_45220_0f8ab2d515879d560894819d31dc3add.webp 760w,
/community/media/blogs/kafka-controller-broker-explained/epoch-number_hu0d56464ab7710eb0c72339108d848be9_45220_1200x1200_fit_q75_h2_lanczos_2.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-controller-broker-explained/epoch-number_hu0d56464ab7710eb0c72339108d848be9_45220_60f7d0456161f3cf7749b27aae0caeea.webp"
width="760"
height="288"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Broker 1ãŒæœ€ã‚‚å¤§ãã„&lt;code>controllerEpoch&lt;/code>ã‚’Zookeeperã«ä¿å…¨ã™ã‚‹äº‹ã«ãªã‚Šã€ãã®ä»–å…¨ã¦ã®ã‚ˆã‚Šå°ã•ãªepoch numberã‚’æŒã¤Controllerã‹ã‚‰ã®æŒ‡ç¤ºã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;h3 id="ãã®ä»–ã®å½¹å‰²">ãã®ä»–ã®å½¹å‰²&lt;/h3>
&lt;p>Controllerã«ã¯ä»–ã«ã‚‚ã‚„ã‚„åœ°å‘³ãªå½¹å‰²ã‚’æ‹…ã„ã¾ã™ï¼š&lt;/p>
&lt;ul>
&lt;li>æ–°ã—ã„Topicã®ä½œæˆ&lt;/li>
&lt;li>æ–°ã—ã„Partitionã®ä½œæˆ&lt;/li>
&lt;li>Topicã®å‰Šé™¤&lt;/li>
&lt;/ul>
&lt;p>ã“ã‚Œã‚‰å‡¦ç†ã¯ã€ä»¥å‰ã«ã¯ã‚„ã‚„ä¹±æš´ãªæ–¹æ³•ã§&lt;sup id="fnref:4">&lt;a href="#fn:4" class="footnote-ref" role="doc-noteref">4&lt;/a>&lt;/sup>å‡¦ç†ã•ã‚Œã¦ã„ã¾ã—ãŸãŒã€version 0.11ã¨1.0ã‹ã‚‰ã¯Controllerã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¦å‡¦ç†ã™ã‚‹æ–¹æ³•ã«ã¨å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯&lt;a href="https://kafka.apache.org/documentation/#adminapi" target="_blank" rel="noopener">Admin Client API&lt;/a>ã¨ã—ã¦æä¾›ã•ã‚Œã€Kafkaã‚¯ãƒ©ã‚¹ã‚¿ã¸ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚¢ãƒ—ãƒªã‚„ç®¡ç†è€…ã«ã‚‚å®¹æ˜“ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="2 Minutes Streaming" srcset="
/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_69bf0270813a154536ca6866d0eebe28.webp 400w,
/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_9b81ef5fad55639d712bb44153e40131.webp 760w,
/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_69bf0270813a154536ca6866d0eebe28.webp"
width="760"
height="399"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ã“ã®ã‚¨ãƒ³ãƒˆãƒªã®è‘—è€…ã§ã‚ã‚‹&lt;a href="../../authors/stanislav/">Stanislav Kozlovski&lt;/a> ã¯&lt;a href="https://2minutestreaming.com/" target="_blank" rel="noopener">2 Minute Streaming&lt;/a>ã¨ã„ã†Kafkaã«é–¢ã™ã‚‹éš”é€±ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ¬ã‚¿ãƒ¼ã‚’ç™ºè¡Œã—ã¦ã„ã¾ã™ã€‚æ˜¯éè³¼èª­ã—ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>(è¨³è€…æ³¨)ã“ã‚Œã¯Zookeeperã‚’ã‚¯ãƒ©ã‚¹ã‚¿ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã«åˆ©ç”¨ã™ã‚‹å ´åˆã®è©±ã§ã€&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-595%3A&amp;#43;A&amp;#43;Raft&amp;#43;Protocol&amp;#43;for&amp;#43;the&amp;#43;Metadata&amp;#43;Quorum" target="_blank" rel="noopener">KRaft&lt;/a>ã¨å‘¼ã°ã‚Œã‚‹Raftãƒ™ãƒ¼ã‚¹ã®ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹ãƒ¢ãƒ‡ãƒ«ã§ã¯3ä»¥ä¸Šã®ControllerãŒå­˜åœ¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>(è¨³è€…æ³¨)Kafka2.4ã‚ˆã‚Šã€æœ€å¯„ã‚Šã®ãƒ¬ãƒ—ãƒªã‚«ã‹ã‚‰Readã™ã‚‹(&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-392%3A&amp;#43;Allow&amp;#43;consumers&amp;#43;to&amp;#43;fetch&amp;#43;from&amp;#43;closest&amp;#43;replica" target="_blank" rel="noopener">KIP-392&lt;/a>)æ©Ÿèƒ½ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>â€Fencing Token&amp;quot;ã¨ã‚‚å‘¼ã°ã‚Œã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:4">
&lt;p>Bashã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã£ã¦ç›´æ¥Zookeeperã‚’æ›´æ–°ã®ä¸Šã€Controllerã‚„ãã®ä»–BrokerãŒãã®å¤‰æ›´ã‚’å—ã‘å–ã‚‹ã®ã‚’å¾…ã¤ã€ã¨ã„ã†å®Ÿè£…ã§ã—ãŸã€‚&amp;#160;&lt;a href="#fnref:4" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Tiered Storageã¯ä½•æ•…ãã‚“ãªã«é‡è¦ãªã®ã‹ï¼Ÿ</title><link>https://confluent-jp.github.io/community/blog/kip405-why-tiered-storage-important/</link><pubDate>Sun, 06 Aug 2023 00:00:00 +0000</pubDate><guid>https://confluent-jp.github.io/community/blog/kip405-why-tiered-storage-important/</guid><description>&lt;h2 id="tiered-storageã¨ã¯">Tiered Storageã¨ã¯&lt;/h2>
&lt;p>ä»Šå¹´ã®å¾ŒåŠã«ãƒªãƒªãƒ¼ã‚¹ãŒäºˆå®šã•ã‚Œã¦ã„ã‚‹&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/Release&amp;#43;Plan&amp;#43;3.6.0" target="_blank" rel="noopener">Apache Kafka 3.6&lt;/a>ã«ã¯ã€Tiered Storageã¨å‘¼ã°ã‚Œã‚‹Kafkaã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãŒå¾…ã¡æœ›ã‚“ã æ–°æ©Ÿèƒ½ãŒå«ã¾ã‚Œã‚‹äºˆå®šã§ã™ã€‚ã“ã®æ©Ÿèƒ½ã¯&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-405%3A&amp;#43;Kafka&amp;#43;Tiered&amp;#43;Storage" target="_blank" rel="noopener">KIP-405&lt;/a>ã¨ã—ã¦ä½•å¹´ã‚‚å‰ã«ç™»éŒ²ã•ã‚ŒãŸKIPã§ã‚ã‚Šã€é•·ã„æœŸé–“ã‚’ã‹ã‘ã¦ã‚ˆã†ã‚„ããƒªãƒªãƒ¼ã‚¹ç›®å‡¦ãŒçµŒã¡ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ã“ã‚Œã¾ã§Kafkaã®ãƒ‡ãƒ¼ã‚¿ã¯å¸¸ã«Brokerã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«æ ¼ç´ã•ã‚Œã¦ã„ã¾ã—ãŸãŒã€ã“ã‚Œã‚’äºŒå±¤åŒ–ã—ã¦å¤ã„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’è‡ªå‹•çš„ã«é€€é¿ã™ã‚‹ã¨ã„ã†æ©Ÿèƒ½ã§ã™ã€‚Kafkaã«æ ¼ç´ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«é€€é¿ã™ã‚‹ã¨ã„ã†ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¯ä¸€èˆ¬çš„ã§ã‚ã‚Šã€ã“ã‚Œã¾ã§ã¯Kafka Connectã‚³ãƒã‚¯ã‚¿ã‚’ä½¿ã£ã¦è‡ªåˆ†ã§é€€é¿ã•ã›ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å–ã£ã¦ã„ã¾ã—ãŸã€‚ã“ã‚Œã‚’Kafkaãƒã‚¤ãƒ†ã‚£ãƒ–ãªæ©Ÿèƒ½ã¨ã—ã¦æä¾›ã™ã‚‹ã€ãã®å½¹å‰²ã‚’Kafka BrokerãŒè¡Œã†ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã¯ã“ã®ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯éš è”½åŒ–ã•ã‚Œã¦ãŠã‚Šã€æ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆã‚‚å¤ã„ã‚¤ãƒ™ãƒ³ãƒˆã‚‚åŒã˜ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹äº‹ãŒå‡ºæ¥ã¾ã™ã€‚&lt;/p>
&lt;h2 id="tiered-storageã®å‹•ã---å›³è§£">Tiered Storageã®å‹•ã - å›³è§£&lt;/h2>
&lt;p>ã“ã‚Œã¾ã§é€šã‚Šã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ã‚‰ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆã¯kafka Brokerã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚»ã‚°ãƒ¡ãƒ³ãƒˆå˜ä½ã§ä¿å­˜ã•ã‚Œã¾ã™ã€‚ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚Šã€ãƒ©ãƒ³ãƒ€ãƒ ã‚¢ã‚¯ã‚»ã‚¹ã§ã¯ãªãã‚¢ãƒšãƒ³ãƒ‰ã§ã—ã‹ãƒ‡ãƒ¼ã‚¿ã‚’è¶³ã›ãªã„ç‚ºã€æœ€ã‚‚æ–°ã—ã„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ (Active Segmentã¨å‘¼ã°ã‚Œã¾ã™) ä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸å¯å¤‰ (Immutable) ã§ã™ã€‚&lt;/p>
&lt;p>Tiered Storageã¯ã“ã®ã†ã¡å¤ã„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’è‡ªå‹•çš„ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«é€€é¿ã—ã¾ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Storage phase-1" srcset="
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-1_hu2024f9fb0e264eb23f1f5629f1888bef_131836_307dc89e1a68d87bc27b49159af2e082.webp 400w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-1_hu2024f9fb0e264eb23f1f5629f1888bef_131836_0c117106ee083960e7059ed25e9ffecd.webp 760w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-1_hu2024f9fb0e264eb23f1f5629f1888bef_131836_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-1_hu2024f9fb0e264eb23f1f5629f1888bef_131836_307dc89e1a68d87bc27b49159af2e082.webp"
width="760"
height="290"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>ä¸­ã§ã¯æ–°ã—ãRemoteLogManagerã¨å‘¼ã°ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒã€ã“ã‚Œã¾ã§ã®LogManagerã«è¿‘ã„å½¹å‰²ã‚’æœãŸã—ã¤ã¤ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚³ãƒ”ãƒ¼ã—ã€åˆã‚ã›ã¦ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹çŠ¶æ…‹ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¿æŒã—ã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Storage phase-2" srcset="
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-2_hu86fab6f33ca7c672a829674acdc1ce76_168812_ed30da300d0b9b691d188362efbc7e4f.webp 400w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-2_hu86fab6f33ca7c672a829674acdc1ce76_168812_d4ef38034777db186c40e196ccf45f74.webp 760w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-2_hu86fab6f33ca7c672a829674acdc1ce76_168812_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-2_hu86fab6f33ca7c672a829674acdc1ce76_168812_ed30da300d0b9b691d188362efbc7e4f.webp"
width="760"
height="277"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>ä¸Šã«ã‚ã‚‹ã‚ˆã†ã«ã€Brokerå´ã®ä¿å…¨æœŸé–“ (Retention Period) ã‚’è¶…éã—ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãŒå‰Šé™¤ã•ã‚ŒãŸå¾Œã‚‚ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã¯ãã®ã‚³ãƒ”ãƒ¼ãŒæ®‹ã‚Šã¾ã™ã€‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å‹•ãã¯ã“ã‚Œã ã‘ã§ã€ãƒªãƒ¢ãƒ¼ãƒˆã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãŒæˆ»ã£ã¦ãã‚‹æ§˜ãªäº‹ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã‚Œã¾ã§ã®Log Managerã®å½¹å‰²ã‚‚ãã®ã¾ã¾ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ­ã‚°ã¯ä»Šã¾ã§é€šã‚Šç®¡ç†ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯æœ€æ–°ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã«é›†ä¸­ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Storage phase-3" srcset="
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-3_hufec61c00674d614f5445ee3899763482_184498_13555c5a91b8f7799d7e3a3c89dd36dd.webp 400w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-3_hufec61c00674d614f5445ee3899763482_184498_38b70ca4b82c8226d2b8975dc87ab4fb.webp 760w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-3_hufec61c00674d614f5445ee3899763482_184498_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-3_hufec61c00674d614f5445ee3899763482_184498_13555c5a91b8f7799d7e3a3c89dd36dd.webp"
width="760"
height="277"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
æ›¸ãè¾¼ã¿ã¯å½“ç„¶æœ€æ–°ã§ã‚ã‚‹Active Segmentã«ã—ã‹ç™ºç”Ÿã—ã¾ã›ã‚“ãŒã€èª­ã¿è¾¼ã¿ã‚‚å¤šå°‘ã®ãƒ©ã‚°ã¯ã‚ã‚ŠãªãŒã‚‰ã‚‚ã»ã¼æœ€æ–°ã«è¿‘ã„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¨ãªã‚Šã¾ã™ã€‚ã“ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã“ã‚Œã¾ã§ã¨ä½•ã‚‚å¤‰ã‚ã‚‰ãšã€ä»Šã¾ã§é€šã‚ŠBrokerãŒãƒ‡ã‚£ã‚¹ã‚¯I/OçµŒç”±ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¸°ã—ã¾ã™ã€‚&lt;/p>
&lt;p>é•ã„ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¤ã„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’æŒ‡å®šã—ã¦èª­ã¿è¾¼ã¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ãŸå ´åˆã§ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Storage phase-4" srcset="
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-4_hu82aa3a1a927fb65a627ff1f8047c21f4_204292_2a2234b74cfe0781c6e5b4a49c707312.webp 400w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-4_hu82aa3a1a927fb65a627ff1f8047c21f4_204292_0641f49b3b2042ca8b889354eab7f534.webp 760w,
/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-4_hu82aa3a1a927fb65a627ff1f8047c21f4_204292_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kip405-why-tiered-storage-important/storage-phase-4_hu82aa3a1a927fb65a627ff1f8047c21f4_204292_2a2234b74cfe0781c6e5b4a49c707312.webp"
width="760"
height="288"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>æ—¢ã«Brokerã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã¯ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯å­˜åœ¨ã—ã¾ã›ã‚“ãŒã€ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«å­˜åœ¨ã™ã‚‹é™ã‚ŠBrokerã¯ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚&lt;/p>
&lt;h2 id="ãƒ¡ãƒªãƒƒãƒˆ-1---æ‹¡å¼µæ€§-scalability">ãƒ¡ãƒªãƒƒãƒˆ 1 - æ‹¡å¼µæ€§ (Scalability)&lt;/h2>
&lt;p>Kafkaã¯æ‹¡å¼µæ€§ã«æ¥µã‚ã¦å„ªã‚ŒãŸã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚ã‚Šã€åŸå‰‡Brokerãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šæ°´å¹³ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚ä¸€æ–¹ã€æ‹¡å¼µã«ã¯é™ç•ŒãŒã‚ã‚Šã¾ã™ã€‚ä¸€èˆ¬çš„ã«å¤§è¦æ¨¡Kafkaã‚¯ãƒ©ã‚¹ã‚¿ã«ãŠã‘ã‚‹ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¸¯åŸŸã§ã€æ¬¡ã«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã‚’å……åˆ†ç¢ºä¿å‡ºæ¥ç¶šã‘ã‚‹é™ã‚ŠKafkaã‚¯ãƒ©ã‚¹ã‚¿ã¯ç›¸å½“è¦æ¨¡ã¾ã§æ‹¡å¼µå‡ºæ¥ã¾ã™ã€‚Tiered Storageã«ã‚ˆã£ã¦ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã®å‰Šæ¸›ã¨ã‚ˆã‚Šé«˜åº¦ãªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>Kafkaã«ã¨ã£ã¦ãã‚Œãã‚Œã®Topicã®ä¿å…¨æœŸé–“ (Retention Period) ã¨æ›¸ãè¾¼ã¿ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¯åŸºæœ¬çš„ã«ã¯ãƒãƒ©ãƒ³ã‚¹ã‚²ãƒ¼ãƒ ã§ã™ - é«˜æ›¸ãè¾¼ã¿ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã®å ´åˆã¯ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã®å¢—åŠ ã‚’åŠ å‘³ã—ã¦ã‚ˆã‚ŠçŸ­ã„ä¿å…¨æœŸé–“ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¿å…¨æœŸé–“ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯1é€±é–“ã€é€šå¸¸é‹ç”¨ã§ã¯1æ—¥ã¨ã„ã†å ´åˆã‚‚å¤šãã‚ã‚Šã¾ã™ãŒã€é«˜è² è·ã®ã‚¯ãƒ©ã‚¹ã‚¿ã§ã¯æ•°æ™‚é–“ç¨‹åº¦ã«ç•™ã‚ã‚‹äº‹ã‚‚å¤šãã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>kafkaã¯å†…éƒ¨ã§ãƒ‡ãƒ¼ã‚¿ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œãªã£ã¦ã„ã¾ã™ã€‚Replication Factorã¨å‘¼ã°ã‚Œã‚‹ã“ã®è¨­å®šã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯&lt;code>3&lt;/code>ã§ã‚ã‚Šã€ç¨€ã«é‡‘èã‚„ã‚¹ãƒˆãƒ¬ãƒƒãƒã‚¯ãƒ©ã‚¹ã‚¿ (è¤‡æ•°ã®ã‚µã‚¤ãƒˆã«è·¨ãŒã‚‹å¤§ããªã‚¯ãƒ©ã‚¹ã‚¿) ã§ã¯&lt;code>4&lt;/code>ã‚’æŒ‡å®šã™ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ãŒã€ã»ã¨ã‚“ã©ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã¾ã¾ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚ã„ãšã‚Œã«ã›ã‚ˆã€ãã®æŒ‡å®šåˆ†ã ã‘ãƒ‡ãƒ¼ã‚¿ã¯ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ãƒˆã•ã‚Œã‚‹ã®ã§ã€å¿…è¦ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã¯å¢—ãˆã¾ã™ã€‚&lt;/p>
&lt;p>ä¾‹ãˆã°100MBpsã§æ›¸ãè¾¼ã¿ãŒãªã•ã‚Œã‚‹å ´åˆã€ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚è€ƒæ…®ã™ã‚‹ã¨ã‚¯ãƒ©ã‚¹ã‚¿å†…ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¸¯åŸŸã«ã¯300MBpsã€å½“ç„¶ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚‚300MBpsã®ã‚¹ãƒ”ãƒ¼ãƒ‰ã§æ¶ˆè²»ã—ã¾ã™ã€‚ä¿å…¨æœŸé–“ã‚’1æ—¥ã¨ã—ãŸå ´åˆã€100 * 3600 * 3 = 1,080,000MB â‰’ 1TBã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚æ›¸ãè¾¼ã¿ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãŒå€ã«ãªã‚Œã°ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚‚å€ã€å½“ç„¶ä¿å…¨æœŸé–“ã‚’å€ã«ã—ã¦ã‚‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯å€å¿…è¦ã«ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã£ãŸå ´åˆã€ãƒ‡ã‚£ã‚¹ã‚¯ã‚’è¶³ã›ã°è§£æ¶ˆã—ã¾ã™ãŒã€ãã‚Œã‚‚é™ç•Œã‚’è¶…ãˆã‚‹ã¨Brokerè‡ªä½“ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚Tiered Storageã‚’å°å…¥ã™ã‚‹ã¨ã€BrokerãŒå¿…è¦ã¨ã™ã‚‹ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®çµ¶å¯¾é‡ã‚’åˆ¶é™ã§ãã¾ã™ã€‚åŒä¸€ãƒãƒ¼ãƒ‰æ§‹æˆã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã‚’ä¸Šã’ã€å°†æ¥çš„ãªæ‹¡å¼µæ€§ã‚‚é«˜ãå‡ºæ¥ã¾ã™ã€‚&lt;/p>
&lt;h2 id="ãƒ¡ãƒªãƒƒãƒˆ-2---éšœå®³è€æ€§-resiliency">ãƒ¡ãƒªãƒƒãƒˆ 2 - éšœå®³è€æ€§ (Resiliency)&lt;/h2>
&lt;p>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’åˆ†é›¢ã™ã‚‹äº‹ã«ã‚ˆã£ã¦éšœå®³è€æ€§ãŒä¸ŠãŒã‚‹ã¨ã„ã†ã®ã¯ãƒ”ãƒ³ã¨æ¥ãªã„ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ãŒã€Tiered Stoargeã«ã‚ˆã‚‹åŠ¹æœã¨æœŸå¾…ã¯éšœå®³è€æ€§ã®å‘ä¸Šã«ã‚‚é›†ã¾ã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>KafkaãŒä½•äº‹ã‚‚ãªãç¨¼åƒã—ã¦ã„ã‚‹é™ã‚Šã€ã¾ãŸãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã•ã‚Œã¦ã„ã‚‹é™ã‚Šã€Kafkaã‚¯ãƒ©ã‚¹ã‚¿ã¯å‡ä¸€ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æ•£é…ç½®ã—ç®¡ç†å‡ºæ¥ã¾ã™ã€‚ã—ã‹ã—Brokerã®ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã¨å¾©å¸°ã¯å¿…ãšç™ºç”Ÿã—ã¾ã™ã€‚æ™‚ã¨ã—ã¦ãƒãƒ¼ãƒ‰ã‚„ã‚½ãƒ•ãƒˆã®éšœå®³ã«ã‚ˆã£ã¦ã€ä»–ã§ã¯Broker/JVM/Guest OS/Host OS/Host Hardwareã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦ã€ã‚¯ãƒ©ã‚¹ã‚¿æ§‹æˆã¯çŸ­æœŸ/é•·æœŸçš„ã«ãã®æ§‹æˆãŒå¤‰ã‚ã‚Šã¾ã™ - Kafkaã¯çµ¶ãˆãšãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚’å¤‰ãˆã¤ã¤ç¨¼åƒã—ç¶šã‘ã‚‹åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã§ã‚ã‚Šã€æ§‹æˆãŒå¤‰ã‚ã‚‹å‰æã®ä¸Šã§æˆç«‹ã—ã¦ã„ã‚‹æŠ€è¡“ã§ã™ã€‚&lt;/p>
&lt;p>BrokerãŒã‚¯ãƒ©ã‚¹ã‚¿ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰å¤–ã‚Œã‚‹ã¨ã€ãã‚Œã¾ã§ãã®Brokerã§ä¿å…¨ã—ã¦ã„ãŸãƒ‡ãƒ¼ã‚¿ã¯å¿…ãšä½•ã‹ã—ã‚‰ã®æ–¹æ³•ã§ä»–ã®Brokerã«å†é…ç½®ã•ã‚Œãªã‘ã‚Œã°ãƒ‡ãƒ¼ã‚¿ã®ä¿å…¨æ€§ãŒä¿ã¦ã¾ã›ã‚“ã€‚ã“ã®ç‚ºã‚¯ãƒ©ã‚¹ã‚¿ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®å¤‰æ›´ã¯ã€å¤§è¦æ¨¡ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã¨ã€ãƒ‡ãƒ¼ã‚¿ã®ç§»å‹•ã‚’æ„å‘³ã—ã¾ã™ã€‚&lt;/p>
&lt;p>Tiered Storageã«ã‚ˆã£ã¦ç®¡ç†/ç§»å‹•å¯¾è±¡ã¨ãªã‚‹ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ç‰©ç†çš„ãªæ•°ãŒæ¸›ã‚Œã°ã€ãã®åˆ†ã‚¯ãƒ©ã‚¹ã‚¿å†…ã§ç§»å‹•ã™ã‚‹ãƒ‡ãƒ¼ã‚¿é‡ãŒæ¸›å°‘ã—ã€ã¾ãŸå¤§é‡ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã«ä¼´ã†äºŒæ¬¡ç½å®³ã®å±é™ºæ€§ã‚‚æ¸›å°‘ã—ã€çµæœã¨ã—ã¦ã‚ˆã‚Šå®‰å…¨ã«ã€ã‚ˆã‚ŠçŸ­ã„æœŸé–“ã«ã‚¯ãƒ©ã‚¹ã‚¿ãŒæ­£å¸¸çŠ¶æ…‹ã«å¾©å¸°ã—ã¾ã™ã€‚Kafkaã‚¯ãƒ©ã‚¹ã‚¿è‡ªä½“ãŒè»½é‡ã«ãªã‚Œã°ãªã‚‹ã ã‘ã€ä¾‹ãˆã°ã‚³ãƒ³ãƒ†ãƒŠã®æ§˜ã«ã‚ˆã‚Šé »ç¹ã«åˆ·æ–°ã•ã‚Œã‚‹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¸Šã§Kafkaã‚’é‹ç”¨ã™ã‚‹å ´åˆã«ã‚‚å¤§ããªãƒ¡ãƒªãƒƒãƒˆã¨ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;h2 id="ãƒ¡ãƒªãƒƒãƒˆ-3---ãƒªã‚½ãƒ¼ã‚¹ã®æœ‰åŠ¹æ´»ç”¨-resource-utilization">ãƒ¡ãƒªãƒƒãƒˆ 3 - ãƒªã‚½ãƒ¼ã‚¹ã®æœ‰åŠ¹æ´»ç”¨ (Resource Utilization)&lt;/h2>
&lt;p>Kafkaã¨ã¯åŸºæœ¬çš„ã«ãƒ‡ã‚£ã‚¹ã‚¯I/Oã¸ã®è² è·ãŒé«˜ã„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ã“ã‚Œã¯æ›¸ãè¾¼ã¿/èª­ã¿è¾¼ã¿ã®ç™ºç”Ÿé »åº¦ãŒé«˜ãã€ã¾ãŸãƒ‡ã‚£ã‚¹ã‚¯I/Oã®æœ‰åŠ¹åˆ©ç”¨ãŒä»Šå›ã®è¨­è¨ˆæ€æƒ³ã«ç¹”ã‚Šè¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä½µã›ã¦ã€Kafkaã¯åŸå‰‡ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚ã‚Šã€æ§˜ã€…ãªãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ãŒå…±å­˜ã—æ˜“ã„ (å„ã€…ã®ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®å½±éŸ¿ã‚’å—ã‘ã«ãã„) ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°åŸºç›¤ã§ã™ã€‚ã—ã‹ã—ãªãŒã‚‰Kafkaã«ã‚‚ç‰©ç†çš„ãªåˆ¶ç´„ã¯å­˜åœ¨ã—ã€ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®ãƒ‹ãƒ¼ã‚ºçš„ã«ã¯ã‚¯ãƒ©ã‚¹ã‚¿è‡ªä½“ã‚’åˆ†ã‘ã‚‹äº‹ã‚‚å®Ÿéš›ã«ã¯å¤šãã‚ã‚Šã¾ã™ã€‚&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/p>
&lt;p>Tiered Storageã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã€Kafkaã§ã¯çã—ããƒ‡ã‚£ã‚¹ã‚¯I/Oã§ã¯ãªããƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯I/Oã¸ã®æ¯”é‡ãŒé«˜ã„å‡¦ç†ã¨ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã°é•·æœŸé–“å®Ÿè¡Œã™ã‚‹ãƒãƒƒãƒå‡¦ç† (å¤ã„ãƒ‡ãƒ¼ã‚¿ãªã®ã§Tiered StorageçµŒç”±) ã¨ã€è¶…ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãªå‡¦ç†ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‡¦ç† (æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãªã®ã§Brokerã‹ã‚‰) ã¨ã§ã¯Kafkaã‹ã‹ã‚‹ãƒªã‚½ãƒ¼ã‚¹è² è·ãŒå…¨ãç•°ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ç‰¹æ€§ã‚’ä¸Šæ‰‹ãåˆ©ç”¨ã™ã‚Œã°ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œã—ãªãŒã‚‰ä½è² è·ã§ãƒãƒƒãƒå‡¦ç†ã‚’åŒä¸€ã‚¯ãƒ©ã‚¹ã‚¿å†…ã§æ‰±ã†äº‹ã‚‚å‡ºæ¥ã¾ã™ã€‚&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>&lt;/p>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>Tiered Storageã¯Apache Pulserã®æ§˜ãªã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆã¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å®Œå…¨ã«åˆ‡ã‚Šé›¢ã™ç›®çš„ã§å°å…¥ã•ã‚Œã‚‹è¨³ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚Kafkaã¯ã‚ã‚‹æ„å‘³æ„å›³çš„ã«åŸå§‹çš„ãªè¨­è¨ˆã‚’ã—ã¦ã„ã‚‹ç‚¹ãŒé•·æ‰€ã§ã‚ã‚Šã€æ™‚ã¨ã—ã¦çŸ­æ‰€ã¨ãªã‚Šå¾—ã‚‹æŠ€è¡“ã§ã™ã€‚Tiered Stoargeã¯KafkaãŒæœ¬æ¥æŒã¤é«˜ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‹ã¤ä½é…å»¶ãªå‡¦ç†èƒ½åŠ›ã‚’æ®ºã™äº‹ãªãã€çŸ­æ‰€ã§ã‚ã‚‹ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚„ãƒ‡ã‚£ã‚¹ã‚¯I/Oã¨ã„ã†ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’è»½æ¸›ã•ã›å¾—ã‚‹å¯èƒ½æ€§ã‚’æŒã£ãŸéå¸¸ã«æœ‰æœ›ãªæ©Ÿèƒ½ã§ã™ã€‚ä½µã›ã¦ã€ã‚ˆã‚Šã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãªç’°å¢ƒã§å‹•ãæ©Ÿä¼šã®å¢—ãˆãŸKafkaã«ã¨ã£ã¦ã€ãã®æ–°ã—ã„ç’°å¢ƒã«ã‚ˆã‚Šé©åˆæ€§ã®é«˜ã„æ©Ÿèƒ½ã§ã‚ã‚‹ã¨ã‚‚è¨€ãˆã¾ã™ã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>ä¾‹ãˆã°é•·æœŸå®Ÿè¡Œã•ã‚Œã‚‹ãƒãƒƒãƒå‡¦ç†ãŒç¶™ç¶šã—ã¦Kafkaã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹çŠ¶æ…‹ã§ã€éå¸¸ã«ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·è¦ä»¶ã®é«˜ã„ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‡¦ç†ãŒåŒå±…ã™ã‚‹æ§˜ãªå ´åˆã§ã™ã€‚&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>å½“ç„¶ã€å……åˆ†ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¸¯åŸŸãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹å ´åˆã«ã¯ã€ã¨ã„ã†æ¡ä»¶ã¯ä»˜ãã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Kafka Ackså†å…¥é–€</title><link>https://confluent-jp.github.io/community/blog/kafka-acks-explained/</link><pubDate>Tue, 01 Aug 2023 00:00:00 +0000</pubDate><guid>https://confluent-jp.github.io/community/blog/kafka-acks-explained/</guid><description>&lt;blockquote>
&lt;p>ã“ã®ãƒ–ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªã¯Kafkaã‚³ãƒŸãƒƒã‚¿ã§ã‚ã‚‹ Stanislav Kozlovski(&lt;a href="https://https://twitter.com/BdKozlovski" target="_blank" rel="noopener">ğ•&lt;/a>|&lt;a href="https://www.linkedin.com/in/stanislavkozlovski/" target="_blank" rel="noopener">Ln&lt;/a>) ã®ã‚µã‚¤ãƒˆã§2022/11/06ã«å…¬é–‹ã•ã‚ŒãŸ&lt;a href="https://www.linkedin.com/pulse/kafka-acks-explained-stanislav-kozlovski/" target="_blank" rel="noopener">Kafka Acks Explained&lt;/a>ã®æ—¥æœ¬èªè¨³ã§ã™ã€‚Stanislavæœ¬äººã®äº†æ‰¿ã‚’å¾—ã¦ç¿»è¨³/å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>Kafkaã«é–¢ã™ã‚‹ä»•äº‹ã‚’å§‹ã‚ã¦4å¹´ã«ãªã‚Šã¾ã™ãŒã€çµŒé¨“ä¸Šæœªã ã«2ã¤ã®è¨­å®šã«ã¤ã„ã¦åºƒãèª¤è§£ã•ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã‚‹äº‹ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯&lt;code>acks&lt;/code>ã¨&lt;code>min.insync.replicas&lt;/code>ã§ã‚ã‚Šã€ã•ã‚‰ã«ã¯ã“ã®2ã¤ã®è¨­å®šãŒã©ã†å½±éŸ¿ã—åˆã†ã‹ã«ã¤ã„ã¦ã§ã™ã€‚ã“ã®ã‚¨ãƒ³ãƒˆãƒªã¯ã“ã®éå¸¸ã«é‡è¦ãª2ã¤ã®èª¤è§£ã‚’è§£ãã€é©åˆ‡ã«ç†è§£ã—ã¦ã‚‚ã‚‰ã†äº‹ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;h2 id="replication">Replication&lt;/h2>
&lt;p>ã“ã®2ã¤ã®è¨­å®šã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã¯ã¾ãšKafka Replicationãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«ã¤ã„ã¦å°‘ã—ãŠã•ã‚‰ã„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>ã“ã®ãƒ–ãƒ­ã‚°ã®èª­è€…ã®çš†ã•ã‚“ã¯ã‚ã‚‹ç¨‹åº¦Kafkaã«ã¤ã„ã¦ã”å­˜çŸ¥ã ã¨æƒ³å®šã—ã¦ã„ã¾ã™ - ã‚‚ã—è‡ªä¿¡ãŒãªã„å ´åˆã¯ãœã²&lt;a href="https://medium.com/hackernoon/thorough-introduction-to-apache-kafka-6fbf2989bbc1" target="_blank" rel="noopener">Thorough Introduction to Apache Kafka&lt;/a>ã‚‚ã”å‚ç…§ãã ã•ã„ã€‚&lt;/p>
&lt;p>å„Partitionã«ã¯1ã¤ã®Leader Broker(1)ã¨è¤‡æ•°ã®Follower Broker(N)ãŒã‚¢ã‚µã‚¤ãƒ³ã•ã‚Œã¾ã™ã€‚ã“ã®è¤‡è£½ã®æ•°ã¯&lt;code>replication.factor&lt;/code>ã§è¨­å®šã™ã‚‹äº‹ãŒã§ã(1+N)ã¤ã¾ã‚Šç·æ•°ã‚’è¡¨ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã“ã®è¨­å®šã§ã¯ã€Œå¯¾è±¡ã¨ãªã‚‹Partitionã«å¯¾ã—ã¦ã‚¯ãƒ©ã‚¹ã‚¿ä¸Šã§ä½•å€‹ã®è¤‡è£½ãŒå‡ºæ¥ã‚‹ã‹ã€ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;/p>
&lt;p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ã‚Šé€šå¸¸æ¨å¥¨ã™ã‚‹è¨­å®šå€¤ã¯&lt;code>3&lt;/code>ã§ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="Replication Factor" srcset="
/community/media/blogs/kafka-acks-explained/replication-factor_hu30e3aabf839789c5bf75a3316f94b6c4_21497_0d1ca0052156cf2b9740e68dcdd4c65a.webp 400w,
/community/media/blogs/kafka-acks-explained/replication-factor_hu30e3aabf839789c5bf75a3316f94b6c4_21497_f54bf205681a70abfa295c3277922d09.webp 760w,
/community/media/blogs/kafka-acks-explained/replication-factor_hu30e3aabf839789c5bf75a3316f94b6c4_21497_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/replication-factor_hu30e3aabf839789c5bf75a3316f94b6c4_21497_0d1ca0052156cf2b9740e68dcdd4c65a.webp"
width="760"
height="203"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
Producerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯Leader Brokerã«ã®ã¿æ›¸ãè¾¼ã¿ã«è¡Œãã¾ã™ - ã¤ã¾ã‚ŠFollower Brokerã¸ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯éåŒæœŸã«è¡Œã‚ã‚Œã¾ã™ã€‚ã“ã“ã§åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦è€ƒæ…®ã—ãªã„ã¨ã„ã‘ãªã„ã®ã¯ã€ä½•ã‹ã—ã‚‰ã®æ–¹æ³•ã§ã€Œã“ã‚Œã‚‰ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹å‡¦ç†ãŒã©ã®ã‚ˆã†ã«Leaderã«è¿½å¾“ã™ã¹ãã‹ã€ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã™ã€‚å…·ä½“çš„ã«ã¯ã€ŒLeaderã«æ›¸ãè¾¼ã¾ã‚ŒãŸæ›´æ–°ãŒFollowerã«ã‚‚åæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹å¦ã‹ã€ã§ã™ã€‚&lt;/p>
&lt;h2 id="in-sync-replicas">In-Sync Replicas&lt;/h2>
&lt;p>in-sync replica(ISR)ã¯å¯¾è±¡Partitionã®æœ€æ–°çŠ¶æ…‹ã¨åŒæœŸãŒå–ã‚Œã¦ã„ã‚‹Brokerã‚’æŒ‡ã—ã¾ã™ã€‚å½“ç„¶Leaderã¯å¸¸ã«ISRã¨ãªã‚Šã€Followerã®å ´åˆã¯Leaderã®æ›´æ–°ã«è¿½ã„ä»˜ãåŒæœŸãŒå–ã‚ŒãŸçŠ¶æ…‹ã®ã‚‚ã®ã®ã¿ISRã¨ãªã‚Šã¾ã™ã€‚ä»®ã«FollowerãŒLeaderã«è¿½å¾“ã§ããªããªã£ãŸå ´åˆã€ãã®Followerã¯ISRã§ã¯ãªããªã‚Šã¾ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="In-Sync Replicas" srcset="
/community/media/blogs/kafka-acks-explained/in-sync-replicas_hu976122a385339436764fa5a7b293f0d1_30553_fce72e1100ff5fc9564552f1283799b8.webp 400w,
/community/media/blogs/kafka-acks-explained/in-sync-replicas_hu976122a385339436764fa5a7b293f0d1_30553_53b76570ba3a381743ccf6f03feacf22.webp 760w,
/community/media/blogs/kafka-acks-explained/in-sync-replicas_hu976122a385339436764fa5a7b293f0d1_30553_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/in-sync-replicas_hu976122a385339436764fa5a7b293f0d1_30553_fce72e1100ff5fc9564552f1283799b8.webp"
width="760"
height="247"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ä¸Šã®å›³ã§ã¯Broker 3ã¯åŒæœŸã•ã‚Œã¦ã„ãªã„ã®ã§ISRã§ã¯ãªã„ã€ã¤ã¾ã‚Šout-of-syncã¨ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>ã¡ãªã¿ã«ã€å³å¯†ã«ã¯ISRã‹å¦ã‹ã¨ã„ã†åˆ¤æ–­ã¯ã‚‚ã†å°‘ã—è¤‡é›‘ã§ã€ã“ã“ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã™ã‚“ãªã‚Šã€Œã“ã®Followerã¯æœ€æ–°ã®çŠ¶æ…‹ã‹ã€ã¨åˆ¤æ–­å‡ºæ¥ã‚‹è¨³ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã å³å¯†ãªè©±ã‚’ã—å§‹ã‚ã‚‹ã¨ã“ã®ã‚¨ãƒ³ãƒˆãƒªã®ä¸»æ—¨ã‹ã‚‰å¤–ã‚Œã‚‹ã®ã§ã€ã“ã“ã§ã¯ä¸Šã®å›³ã«ã‚ã‚‹èµ¤ã„Brokerã¯åŒæœŸãŒå–ã‚Œã¦ã„ãªã„ã¨ã€è¦‹ãŸã¾ã¾æ‰ãˆã¦ãã ã•ã„ã€‚&lt;/p>
&lt;h2 id="acks">Acks&lt;/h2>
&lt;p>Acksã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (Producer) å´ã®è¨­å®šã§ã€ã€Œã©ã“ã¾ã§Followã‚’å«ã‚ã¦æ›¸ãè¾¼ã¿ã®ç¢ºèªãŒå–ã‚Œã¦ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ç­”ã™ã‚‹ã‹ã€ã‚’æŒ‡å®šã™ã‚‹ã‚‚ã®ã§ã™ã€‚æœ‰åŠ¹ãªå€¤ã¯&lt;code>0&lt;/code>ã€&lt;code>1&lt;/code>ã€ãã—ã¦&lt;code>all&lt;/code>ã®3ã¤ã§ã™ã€‚&lt;/p>
&lt;h3 id="acks0">acks=0&lt;/h3>
&lt;p>&lt;code>0&lt;/code>ãŒè¨­å®šã•ã‚ŒãŸå ´åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯Brokerã¾ã§åˆ°é”ã—ãŸã‹ã®ç¢ºèªã•ãˆè¡Œã„ã¾ã›ã‚“ - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒKafka Brokerã«å¯¾ã—ã¦é€ã‚‰ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ackã‚’è¿”ã—ã¾ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=0" srcset="
/community/media/blogs/kafka-acks-explained/ack-0_hu0550e2dc4172b509b74ba25178351429_24893_3c44fb1f740910333022481170b7baae.webp 400w,
/community/media/blogs/kafka-acks-explained/ack-0_hu0550e2dc4172b509b74ba25178351429_24893_882b78cb72dd80307fdacbd72dcd1221.webp 760w,
/community/media/blogs/kafka-acks-explained/ack-0_hu0550e2dc4172b509b74ba25178351429_24893_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/ack-0_hu0550e2dc4172b509b74ba25178351429_24893_3c44fb1f740910333022481170b7baae.webp"
width="760"
height="201"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ackã¨å‘¼ã³ã¾ã™ãŒBrokerã‹ã‚‰ã®è¿”ç­”ã•ãˆå¾…ã¡ã¾ã›ã‚“ã€‚é€ã‚ŒãŸã‚‰OKã§ã™ã€‚&lt;/p>
&lt;h3 id="acks1">acks=1&lt;/h3>
&lt;p>&lt;code>1&lt;/code>ãŒè¨­å®šã•ã‚ŒãŸå ´åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (Producer) ã¯Leaderã«ã¾ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ°é”ã—ãŸæ™‚ç‚¹ã§æ›¸ãè¾¼ã¿ã®å®Œäº†ã¨åˆ¤æ–­ã—ã¾ã™ã€‚Leader Brokerã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã£ãŸæ™‚ç‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=0" srcset="
/community/media/blogs/kafka-acks-explained/ack-1_hufbb81d13ec3e2d13fe50ef9ee9b16565_25528_3111a28552f0a098342a58fa79fec9da.webp 400w,
/community/media/blogs/kafka-acks-explained/ack-1_hufbb81d13ec3e2d13fe50ef9ee9b16565_25528_e9144a72afa66fafd760c8736f931a9e.webp 760w,
/community/media/blogs/kafka-acks-explained/ack-1_hufbb81d13ec3e2d13fe50ef9ee9b16565_25528_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/ack-1_hufbb81d13ec3e2d13fe50ef9ee9b16565_25528_3111a28552f0a098342a58fa79fec9da.webp"
width="760"
height="201"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã£ã¦ãã‚‹ã®ã‚’å¾…ã¡ã¾ã™ã€‚Leaderã‹ã‚‰ã®è¿”ç­”ãŒåˆ°ç€ã—ãŸæ™‚ç‚¹ã§å®Œäº†ã¨åˆ¤æ–­ã—ackã¨ã—ã¾ã™ã€‚Leaderã¯å—ã‘å–ã‚Šæ¬¡ç¬¬ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ã®ã§ã€Followerã¸ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã¯éåŒæœŸã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;h3 id="acksall">acks=all&lt;/h3>
&lt;p>&lt;code>all&lt;/code>ã¨è¨­å®šã•ã‚ŒãŸå ´åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯å…¨ã¦ã®ISRã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ°é”ã—ãŸæ™‚ç‚¹ã§æ›¸ãè¾¼ã¿ã®å®Œäº†ã¨åˆ¤æ–­ã—ã¾ã™ã€‚ã“ã®éš›Leader BrokerãŒKafkaå´ã®æ›¸ãè¾¼ã¿åˆ¤å®šã‚’è¡Œãªã£ã¦ãŠã‚Šã€å…¨ã¦ã®ISRã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ°é”ã®ä¸Šã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=all incomplete" srcset="
/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_c0ae40d167ec22fd1a697d124a14ea8d.webp 400w,
/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_d7dcaf69c8cd6d40de1b4c5fa07bce88.webp 760w,
/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_c0ae40d167ec22fd1a697d124a14ea8d.webp"
width="760"
height="201"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ä¸Šã®å›³ã®çŠ¶æ…‹ã§ã¯Broker 3ã¯ã¾ã ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã£ã¦ã„ã¾ã›ã‚“ã€‚ã“ã®ç‚ºLeaderã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã›ã‚“ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=all completed" srcset="
/community/media/blogs/kafka-acks-explained/acs-all-completed_hu40e2b48bcec98f93fca3863ace2b1192_26398_516f5fcece0585c45a349a2c530fc785.webp 400w,
/community/media/blogs/kafka-acks-explained/acs-all-completed_hu40e2b48bcec98f93fca3863ace2b1192_26398_95c6e832fba07495adfbb75a5b8d0104.webp 760w,
/community/media/blogs/kafka-acks-explained/acs-all-completed_hu40e2b48bcec98f93fca3863ace2b1192_26398_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/acs-all-completed_hu40e2b48bcec98f93fca3863ace2b1192_26398_516f5fcece0585c45a349a2c530fc785.webp"
width="760"
height="201"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
å…¨ã¦ã®ISRã«æ¸¡ã£ã¦åˆã‚ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;h3 id="acksã®æ©Ÿèƒ½æ€§">acksã®æ©Ÿèƒ½æ€§&lt;/h3>
&lt;p>ã“ã®é€šã‚Šacksã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ãƒ‡ãƒ¼ã‚¿æ¬ æè€æ€§ã®ãƒãƒ©ãƒ³ã‚¹ã‚’æ±ºã‚ã‚‹éå¸¸ã«æœ‰ç›Šãªè¨­å®šã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ä¿å…¨ã‚’å„ªå…ˆã™ã‚‹ã®ã§ã‚ã‚Œã°&lt;code>acks=all&lt;/code>ã®è¨­å®šãŒé©åˆ‡ã§ã™ã€‚&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> ä¸€æ–¹ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚„ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«é–¢ã™ã‚‹è¦ä»¶ãŒæ¥µã‚ã¦é«˜ã„å ´åˆã«ã¯&lt;code>0&lt;/code>ã«è¨­å®šã™ã‚Œã°æœ€ã‚‚åŠ¹ç‡ãŒè‰¯ããªã‚Šã¾ã™ãŒã€åŒæ™‚ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ­ã‚¹ã®å¯èƒ½æ€§ã¯é«˜ã¾ã‚Šã¾ã™ã€‚&lt;/p>
&lt;h2 id="minimum-in-sync-replicas">Minimum In-Sync Replicas&lt;/h2>
&lt;p>&lt;code>acks=all&lt;/code>ã®è¨­å®šã«é–¢ã—ã¦ã€ã‚‚ã†ä¸€ã¤é‡è¦ãªè¦ç´ ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>ä¾‹ãˆã°LeaderãŒå…¨ã¦ã®ISRã¸ã®æ›¸ãè¾¼ã¿å®Œäº†ã—ãŸä¸Šã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ã¨ã—ã¦ã€Leaderã®ã¿ãŒISRã ã£ãŸå ´åˆã€çµæœã¨ã—ã¦&lt;code>acks=1&lt;/code>ã¨æŒ¯ã‚‹èˆã„ã¯åŒã˜ã¨ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ&lt;/p>
&lt;p>ã“ã“ã§&lt;code>min.insync.replicas&lt;/code>ã®è¨­å®šãŒé‡è¦ã«ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>&lt;code>min.insync.replicas&lt;/code>ã¨ã„ã†Brokerå´ã®è¨­å®šã¯ã€&lt;code>acks=all&lt;/code>ã®éš›ã«ã€Œæœ€ä½ã„ãã¤ã®ISRã¨ãªã£ã¦ã„ã‚‹ã‹ (Leaderã‚’å«ã‚ã¦å¹¾ã¤ã®ãƒ¬ãƒ—ãƒªã‚«ãŒæœ€æ–°çŠ¶æ…‹ã‹) ã‚’æŒ‡å®šã™ã‚‹ã‚‚ã®ã§ã™ã€‚ã¤ã¾ã‚ŠLeaderã¯ã€&lt;code>acks=all&lt;/code>ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦æŒ‡å®šã•ã‚ŒãŸISRã«æº€ãŸãªã„ã¾ã§ã¯è¿”ç­”ã›ãšã€ã¾ãŸãã‚ŒãŒä½•ã‹ã—ã‚‰ã®ç†ç”±ã§é”æˆã§ããªã„å ´åˆã«ã¯ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ä¿å…¨è¦³ç‚¹ã§ã®ã‚²ãƒ¼ãƒˆã‚­ãƒ¼ãƒãƒ¼ã®æ§˜ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=all and ISR=2" srcset="
/community/media/blogs/kafka-acks-explained/acks-all-isr-2_hub8eff15aeeef74355ae44643b51e51f5_28460_c68b5a3947a2b0f20bf8ea75ce7a2101.webp 400w,
/community/media/blogs/kafka-acks-explained/acks-all-isr-2_hub8eff15aeeef74355ae44643b51e51f5_28460_249c85c3d6a5b99c5af7bf892f6e56ab.webp 760w,
/community/media/blogs/kafka-acks-explained/acks-all-isr-2_hub8eff15aeeef74355ae44643b51e51f5_28460_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/acks-all-isr-2_hub8eff15aeeef74355ae44643b51e51f5_28460_c68b5a3947a2b0f20bf8ea75ce7a2101.webp"
width="760"
height="201"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ä¸Šè¨˜ã®çŠ¶æ…‹ã ã¨Broker 3ã¯åŒæœŸã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã§ã™ã€‚ã—ã‹ã—ãªãŒã‚‰&lt;code>min.insync.replicas=2&lt;/code>ã¨ãªã£ã¦ã„ã‚‹å ´åˆã«ã¯æ¡ä»¶ã‚’æº€ãŸã™ç‚ºã“ã®æ™‚ç‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=all and ISR below min.insync.replicas" srcset="
/community/media/blogs/kafka-acks-explained/ack-all-error_hu2fd9c2a4aa3141a871510012387c44d9_34884_49566929a4d489d75f27fe22a6bcec7c.webp 400w,
/community/media/blogs/kafka-acks-explained/ack-all-error_hu2fd9c2a4aa3141a871510012387c44d9_34884_924c01716b6e3c2021b34f2f98f42045.webp 760w,
/community/media/blogs/kafka-acks-explained/ack-all-error_hu2fd9c2a4aa3141a871510012387c44d9_34884_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/ack-all-error_hu2fd9c2a4aa3141a871510012387c44d9_34884_49566929a4d489d75f27fe22a6bcec7c.webp"
width="760"
height="192"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
Broker 2ã¨3ãŒåŒæœŸã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã§ã™ã€‚ã“ã®å ´åˆæŒ‡å®šã•ã‚ŒãŸ&lt;code>min.insync.replicas&lt;/code>ã‚’ä¸‹å›ã‚‹ãŸã‚Leaderã‹ã‚‰ã¯ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã‚‹ã€ã¤ã¾ã‚Šæ›¸ãè¾¼ã¿ã¯å¤±æ•—ã—ã¾ã™ã€‚ä¸€æ–¹åŒã˜çŠ¶æ³ã§ã‚ã£ã¦ã‚‚&lt;code>acks&lt;/code>ã®è¨­å®šãŒ&lt;code>0&lt;/code>ã‚‚ã—ãã¯&lt;code>1&lt;/code>ã®å ´åˆã«ã¯æ­£å¸¸ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;h3 id="æ³¨æ„ç‚¹">æ³¨æ„ç‚¹&lt;/h3>
&lt;p>ä¸€èˆ¬çš„ã«&lt;code>min.insync.replicas&lt;/code>ã¯ã€ŒLeaderãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ç­”ã™ã‚‹éš›ã«ã€ã©ã‚Œã ã‘ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Œäº†ã—ã¦ã„ã‚‹ã‹ã‚’æŒ‡å®šã™ã‚‹ã€ã¨è§£é‡ˆã•ã‚Œã¦ã„ã¾ã™ãŒã€ã“ã‚Œã¯èª¤ã‚Šã§ã™ã€‚æ­£ç¢ºã«ã¯ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ç‚ºã«æœ€ä½ã„ãã¤ã®ãƒ¬ãƒ—ãƒªã‚«ãŒå­˜åœ¨ã™ã‚‹ã‹ã€ã‚’æŒ‡å®šã™ã‚‹è¨­å®šã§ã™ã€‚
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="acks=all incomplete" srcset="
/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_c0ae40d167ec22fd1a697d124a14ea8d.webp 400w,
/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_d7dcaf69c8cd6d40de1b4c5fa07bce88.webp 760w,
/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/ack-all_hubb3072fc779981dffa72d32676766abf_24119_c0ae40d167ec22fd1a697d124a14ea8d.webp"
width="760"
height="201"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ä¸Šè¨˜ã®å ´åˆã€Broker 1ã‹ã‚‰3ã¾ã§ãŒå…¨ã¦åŒæœŸçŠ¶æ…‹ã§ã™ã€‚ã“ã®æ™‚ã«æ–°ãŸãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ (ã“ã“ã§ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸&lt;code>6&lt;/code>) ã‚’å—ã‘å–ã£ãŸå ´åˆã€Broker 2ã¸ã®åŒæœŸãŒå®Œäº†ã—ã¦ã‚‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯è¿”ã—ã¾ã›ã‚“ã€‚ã“ã®å ´åˆã€å‡¦ç†æ™‚ã«ISRã¨ãªã£ã¦ã„ã‚‹Broker 3ã¸ã®åŒæœŸãŒå®Œäº†ã—ã¦åˆã‚ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã•ã‚Œã¾ã™ã€‚&lt;/p>
&lt;h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚&lt;/h2>
&lt;p>å›³ã§èª¬æ˜ã—ãŸã“ã¨ã«ã‚ˆã£ã¦ç†è§£ãŒæ·±ã¾ã£ãŸã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ãŠã•ã‚‰ã„ã™ã‚‹ã¨ã€&lt;code>acks&lt;/code>ã¨&lt;code>min.insync.replicas&lt;/code>ã¯Kafkaã¸ã®æ›¸ãè¾¼ã¿ã«ãŠã‘ã‚‹æ¬ æä½“åˆ¶ã‚’æŒ‡å®šã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>acks=0&lt;/code> - æ›¸ãè¾¼ã¿ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒLeaderã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã£ãŸæ™‚ç‚¹ã§æˆåŠŸã¨ã¿ãªã—ã¾ã™ã€‚Leaderã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…ã¤ã“ã¨ã¯ã—ã¾ã›ã‚“ã€‚&lt;/li>
&lt;li>&lt;code>acks=1&lt;/code> - æ›¸ãè¾¼ã¿ã¯Leaderã¸ã®æ›¸ãè¾¼ã¿ãŒå®Œäº†ã—ãŸæ™‚ç‚¹ã§æˆåŠŸã¨ã¿ãªã—ã¾ã™ã€‚&lt;/li>
&lt;li>&lt;code>acks=all&lt;/code> - æ›¸ãè¾¼ã¿ã¯ISRå…¨ã¦ã¸ã®æ›¸ãè¾¼ã¿ãŒå®Œäº†ã—ãŸæ™‚ç‚¹ã§æˆåŠŸã¨ã¿ãªã—ã¾ã™ã€‚ISRãŒ&lt;code>min.insync.replicas&lt;/code>ã‚’ä¸‹å›ã‚‹å ´åˆã«ã¯å‡¦ç†ã•ã‚Œã¾ã›ã‚“ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ãã®ä»–æƒ…å ±">ãã®ä»–æƒ…å ±&lt;/h3>
&lt;p>Kafkaã¯è¤‡é›‘ãªåˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã§ã‚ã‚Šã€å­¦ã°ãªã‘ã‚Œã°ã„ã‘ãªã„äº‹ãŒå¤šã„ã®ã‚‚äº‹å®Ÿã§ã™ã€‚Kafkaã®ä»–ã®é‡è¦ãªè¦ç´ ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.confluent.io/blog/apache-kafka-data-access-semantics-consumers-and-membership/" target="_blank" rel="noopener">Kafka consumer data-access semantics&lt;/a> - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (Consumer) ã«ãŠã‘ã‚‹æ¬ æè€æ€§ã€å¯ç”¨æ€§ã€ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ç¢ºä¿ã«é–¢ã‚ã‚‹è©³ç´°ã€‚&lt;/li>
&lt;li>&lt;a href="https://medium.com/@stanislavkozlovski/apache-kafkas-distributed-system-firefighter-the-controller-broker-1afca1eae302" target="_blank" rel="noopener">Kafka controller&lt;/a> - Brokeré–“ã®é€£æºãŒã©ã®æ§˜ã«ãªã•ã‚Œã‚‹ã®ã‹ã®è©³ç´°ã€‚ç‰¹ã«ãƒ¬ãƒ—ãƒªã‚«ãŒéåŒæœŸ (Out-of-Sync) ã¨ãªã‚‹ã®ã¯ã©ã†ã„ã†æ¡ä»¶ä¸‹ã‹ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚&lt;/li>
&lt;li>&lt;a href="https://www.confluent.io/blog/configure-kafka-to-minimize-latency/" target="_blank" rel="noopener">â€œ99th Percentile Latency at Scale with Apache Kafka&lt;/a> - Kafkaã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹Confluent Blogã‚¨ãƒ³ãƒˆãƒªã€‚&lt;/li>
&lt;li>&lt;a href="https://www.confluent.io/resources/kafka-summit-san-francisco-2019/" target="_blank" rel="noopener">Kafka Summit SF 2019 videos&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.confluent.io/blog/" target="_blank" rel="noopener">Confluent blog&lt;/a> - Kafkaã«é–¢ã™ã‚‹æ§˜ã€…ãªãƒˆãƒ”ãƒƒã‚¯ã‚’ç¶²ç¾…ã€‚&lt;/li>
&lt;li>&lt;a href="https://kafka.apache.org/documentation/" target="_blank" rel="noopener">Kafka documentation&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Kafkaã¯ç¶™ç¶šçš„ã‹ã¤ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«é–‹ç™ºã•ã‚Œã¦ã„ã¾ã™ãŒã€æ©Ÿèƒ½è¿½åŠ ã‚„æ”¹å–„ã¯æ´»ç™ºãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã‚Šæ”¯ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚é–‹ç™ºã®æœ€å‰ç·šã§ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹èˆˆå‘³ãŒã‚ã‚‹å ´åˆã¯ãœã²&lt;a href="https://kafka.apache.org/contact" target="_blank" rel="noopener">ãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆ&lt;/a> ã«å‚åŠ ã—ã¦ãã ã•ã„ã€‚&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img alt="2 Minutes Streaming" srcset="
/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_69bf0270813a154536ca6866d0eebe28.webp 400w,
/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_9b81ef5fad55639d712bb44153e40131.webp 760w,
/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
src="https://confluent-jp.github.io/community/community/media/blogs/kafka-acks-explained/two-minites-streaming_hue3ec6dcfa348a79b62ae3c8b92373579_136684_69bf0270813a154536ca6866d0eebe28.webp"
width="760"
height="399"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
ã“ã®ã‚¨ãƒ³ãƒˆãƒªã®è‘—è€…ã§ã‚ã‚‹&lt;a href="../../authors/stanislav/">Stanislav Kozlovski&lt;/a> ã¯&lt;a href="https://2minutestreaming.com/" target="_blank" rel="noopener">2 Minute Streaming&lt;/a>ã¨ã„ã†Kafkaã«é–¢ã™ã‚‹éš”é€±ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ¬ã‚¿ãƒ¼ã‚’ç™ºè¡Œã—ã¦ã„ã¾ã™ã€‚æ˜¯éè³¼èª­ã—ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>(è¨³è€…æ³¨)ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯&lt;code>acks=all&lt;/code>ãŒé©åˆ‡ã§ã‚ã‚Šã€Kafkaã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚‚ã‚ã‚Šã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Streaming Audio - Kafkaã«æœ¬å½“ã«ã‚ã£ãŸ(ã¾ã ã‚ã‚‹)ãƒ¤ãƒã„ãƒã‚°5é¸</title><link>https://confluent-jp.github.io/community/blog/streaming-audio-worst-kafka-bugs/</link><pubDate>Sat, 29 Jul 2023 00:00:00 +0000</pubDate><guid>https://confluent-jp.github.io/community/blog/streaming-audio-worst-kafka-bugs/</guid><description>&lt;h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«&lt;/h2>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=yFlvWRwRTT8&amp;amp;list=PLa7VYi0yPIH1B0i7mhzVi78TIkKSd-0vE" target="_blank" rel="noopener">Streaming Audio&lt;/a>ã¯ConfluentãŒPodcast&amp;amp;YouTubeã‚·ãƒªãƒ¼ã‚ºã¨ã—ã¦æä¾›ã—ã¦ã„ã¾ã™ã€‚æ¯å›ã‚²ã‚¹ãƒˆã‚’è¿ãˆæ§˜ã€…ãªãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ãƒ•ãƒªãƒ¼ã«ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã™ã‚‹ãƒãƒƒãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã§ã€KafkaåˆæœŸé–‹ç™ºãƒ¡ãƒ³ãƒãƒ¼ã®Jun Raoã‚„KRaftã®é–‹ç™ºãƒ¡ãƒ³ãƒãƒ¼ã€Kafkaã®ãƒªã‚¢ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼ç­‰æ§˜ã€…ãªã‚²ã‚¹ãƒˆã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãŒå‚åŠ ã—ã¾ã™ã€‚ä¸­ã§ã‚‚ã€Œã‚¢ãƒŠãƒã‚­ã€ã“ã¨Anna McDonald (Technical Voice of CUstomer @Confluent)ç™»å ´å›ã¯æ¯å›å¿…è¦‹ã§ã€ã„ã¤ã‚‚ä½•ã‹æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>ä»Šå›ã¯ãã®å½¼å¥³ã®ç™»å ´å›ã®ä¸­ã§ã‚‚æœ€ã‚‚æœ€è¿‘ã®å›ã®ã”ç´¹ä»‹ã§ã™ï¼šãŠé¡Œã¯ã€ŒKafkaã«æœ¬å½“ã«ã‚ã£ãŸãƒ¤ãƒã„ãƒã‚°5é¸&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ã€ã§ã™ã€‚(ã‚ªãƒªã‚¸ãƒŠãƒ«ã®å…¬é–‹ã¯2022/12/21) ã“ã®ãƒˆãƒ¼ã‚¯ã§ç´¹ä»‹ã•ã‚ŒãŸJIRAãƒã‚°ã®ä¸€è¦§ã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚çµæ§‹æœ€è¿‘ã«ãªã£ã¦ã‚ˆã†ã‚„ãå…¥ã£ãŸã‚‚ã®ã‚„ã€ã¾ã ç›´ã£ã¦ã„ãªã„ã‚‚ã®ã‚‚ã‚ã‚Šã¾ã™ã€‚Kafkaã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ãªã‚‹ã¹ãè¿½å¾“ã™ã‚‹äº‹ã‚’å¼·ããŠå‹§ã‚ã—ã¦ã„ã¾ã™ãŒã€ã“ã“ã«ã‚ã‚‹ã®ã¯å…¨ä½“ã®ä¸€éƒ¨ã§ã€ãªã‹ãªã‹ã«æ€–ã„ãƒã‚°ã¸ã®ä¿®æ­£ã‚‚å…¥ã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ã‚ãªãŸã®Kafkaã‚¯ãƒ©ã‚¹ã‚¿ã¯ã»ã‚“ã¨ã«å¤§ä¸ˆå¤«ã§ã™ï¼Ÿ&lt;/p>
&lt;h4 id="kafka-10888-sticky-partition-leads-to-uneven-product-msg-resulting-in-abnormal-delays-in-some-partitionshttpsissuesapacheorgjirabrowsekafka-10888">&lt;a href="https://issues.apache.org/jira/browse/KAFKA-10888" target="_blank" rel="noopener">KAFKA-10888: Sticky partition leads to uneven product msg, resulting in abnormal delays in some partitions&lt;/a>&lt;/h4>
&lt;blockquote>
&lt;p>Status: Resolved (3.0.0)&lt;/p>
&lt;/blockquote>
&lt;p>Sticky Partitionerã‚’ä½¿ç”¨æ™‚ã€Partitioné–“ã®å‡¦ç†æ•°ã«å¤§ããªåã‚ŠãŒå‡ºã‚‹æ§˜ãªçŠ¶æ³ã¨ãªã‚Šç‰¹å®šã®Partitionã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãŒæ¥µç«¯ã«ä¸‹ãŒã‚‹äº‹ãŒã‚ã‚‹: å ´åˆã«ã‚ˆã£ã¦ã¯ãƒªã‚«ãƒãƒªä¸èƒ½ãªã»ã©Producerå´ã®ãƒãƒƒãƒãŒè‚¥å¤§åŒ–ã™ã‚‹ã€‚&lt;/p>
&lt;h4 id="kafka-9648-add-configuration-to-adjust-listen-backlog-size-for-acceptorhttpsissuesapacheorgjirabrowsekafka-9648">&lt;a href="https://issues.apache.org/jira/browse/KAFKA-9648" target="_blank" rel="noopener">KAFKA-9648: Add configuration to adjust listen backlog size for Acceptor&lt;/a>&lt;/h4>
&lt;blockquote>
&lt;p>Status: Resolved (3.2.0)&lt;/p>
&lt;/blockquote>
&lt;p>OSãŒLinuxã®å ´åˆã«ç™ºç”Ÿã€‚ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ç­‰ã®éš›ã€Brokerã‹ã‚‰Partition LeaderãŒä»–ã®Brokerã«ç§»ã‚‹ã€ã‚‚ã—ãã¯ç§»ã£ãŸã®ã¡ã«å…ƒã®Brokerã«æˆ»ã‚‹ (Preferred Leader Election) ãŒç™ºç”Ÿã€‚ã“ã®éš›Partitionã«é–¢ã™ã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãŒè¡Œã‚ã‚Œã‚‹ç‚ºã“ã‚Œã‚‰Partitionã‚’å‚ç…§ã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ä¸€æ–‰ã«å†æ¥ç¶šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ã‚‰ã‚Œã‚‹ã€‚çŠ¶æ³ã«ã‚ˆã£ã¦ã¯Linuxã®SYN cookieã®æ©Ÿèƒ½ãŒå‹•ãTCPãƒãƒƒãƒ•ã‚¡ãƒ¼ãŒåˆ¶é™ã•ã‚Œã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãŒå¤§å¹…ã«ä½ä¸‹ã™ã‚‹ã€‚ã“ã‚Œã¯å†æ¥ç¶šã—ãªã„é™ã‚Šå¾©æ—§ã—ãªã„ã€‚&lt;/p>
&lt;h4 id="kafka-12686-race-condition-in-alterisr-response-handlinghttpsissuesapacheorgjirabrowsekafka-12686">&lt;a href="https://issues.apache.org/jira/browse/KAFKA-12686" target="_blank" rel="noopener">KAFKA-12686: Race condition in AlterIsr response handling&lt;/a>&lt;/h4>
&lt;blockquote>
&lt;p>Status: Resolved (3.0.0)&lt;/p>
&lt;/blockquote>
&lt;p>Partition.scalaå†…ã®å‡¦ç†ã«ãŠã„ã¦ã€AlterIsrResponseã¨LeaderAndIsrRequestã®ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãŒèµ·å› ã€‚ã‚¯ãƒ©ã‚¹ã‚¿ã‚µã‚¤ã‚ºãŒå°ã•ãPartitionæ•°ãŒå¤šã„å ´åˆã€Brokerãƒãƒ¼ãƒ‰ã®å¤‰æ›´æ™‚ã«å¤§é‡ã®Partitionå¤‰æ›´ãŒç™ºç”Ÿã™ã‚‹ã€‚ã“ã®éš›AlterIsrManagerãŒãƒšãƒ³ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¦ã—ã¾ã†ç‚ºã€AlterIsrResponseãŒæˆ»ã£ã¦ããŸéš›ã«å‡¦ç†ä¸­ (in Flight) ã§ã‚ã‚‹ã®ã«å‡¦ç†ã‚¿ã‚¹ã‚¯ (Pending) ãŒç„¡ã„ã¨ã„ã†çŸ›ç›¾çŠ¶æ…‹ãŒç™ºç”Ÿã™ã‚‹ã€‚&lt;/p>
&lt;h4 id="kafka-12964-corrupt-segment-recovery-can-delete-new-producer-state-snapshotshttpsissuesapacheorgjirabrowsekafka-12964">&lt;a href="https://issues.apache.org/jira/browse/KAFKA-12964" target="_blank" rel="noopener">KAFKA-12964: Corrupt segment recovery can delete new producer state snapshots&lt;/a>&lt;/h4>
&lt;blockquote>
&lt;p>Status: Resolved (3.0.0)&lt;/p>
&lt;/blockquote>
&lt;p>Brokerã®åœæ­¢æ™‚ã€çŒ¶äºˆæ™‚é–“å†…ã«çµ‚äº†ã—ãªã„å ´åˆã«ã¯ Unclearn Shutdownã¨åˆ¤æ–­ã•ã‚Œã‚‹ã€‚ã“ã®éš›Brokerå¾©å¸°æ™‚ã«æ®‹ã£ã¦ã„ãŸã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ä¸è¦ã¨åˆ¤æ–­ã•ã‚ŒéåŒæœŸã§å‰Šé™¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã®å‰Šé™¤ãŒå®Œäº†ã™ã‚‹å‰ã«åŒã˜ã‚ªãƒ•ã‚»ãƒƒãƒˆã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹çŠ¶æ…‹ã¨ãªã‚‹ã¨ã€æ–°ã—ã„Producer Stateã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒèª¤ã£ã¦å‰Šé™¤ã•ã‚Œã‚‹äº‹ãŒã‚ã‚‹ã€‚&lt;/p>
&lt;h4 id="kafka-14334-delayedfetch-purgatory-not-completed-when-appending-as-followerhttpsissuesapacheorgjirabrowsekafka-14334">&lt;a href="https://issues.apache.org/jira/browse/KAFKA-14334" target="_blank" rel="noopener">KAFKA-14334: DelayedFetch purgatory not completed when appending as follower&lt;/a>&lt;/h4>
&lt;blockquote>
&lt;p>Status: Resolved (3.4.0, 3.3.2)&lt;/p>
&lt;/blockquote>
&lt;p>ConsumerãŒPulgatoryã‹ã‚‰ãƒ•ã‚§ãƒƒãƒã™ã‚‹ã‚±ãƒ¼ã‚¹ã«ãŠã„ã¦ã€é€šå¸¸é€šã‚ŠPartitionãƒªãƒ¼ãƒ€ãƒ¼ã‹ã‚‰ãƒ•ã‚§ãƒƒãƒã™ã‚‹å ´åˆã«ã¯æ­£ã—ããƒ•ã‚§ãƒƒãƒã®å®Œäº†ãŒèªè­˜ã•ã‚Œã‚‹ã€‚ã—ã‹ã—ConsumerãŒãƒ•ã‚©ãƒ­ãƒ¼ãƒ¯ãƒ¼ãŒãƒ•ã‚§ãƒƒãƒã™ã‚‹è¨­å®šã¨ã—ã¦ã„ã‚‹(&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-392%3A&amp;#43;Allow&amp;#43;consumers&amp;#43;to&amp;#43;fetch&amp;#43;from&amp;#43;closest&amp;#43;replica" target="_blank" rel="noopener">KIP-932&lt;/a>)å ´åˆã€ãƒ•ã‚©ãƒ­ãƒ¼ãƒ¯ãƒ¼ã®Partitionã¯Pulgatoryã«å­˜åœ¨ã—ãªã„ç‚ºãƒ•ã‚§ãƒƒãƒå‡ºæ¥ãšã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã™ã‚‹ã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>ã‚ªãƒªã‚¸ãƒŠãƒ«ã¯6é¸ã§ã‚ã‚Šã€ã“ã“ã§ã¯ãã®ã†ã¡&lt;a href="https://issues.apache.org/jira/browse/KAFKA-9211" target="_blank" rel="noopener">KAFKA-9211: Kafka upgrade 2.3.0 may cause tcp delay ack(Congestion Control)&lt;/a>ã‚‚å«ã‚“ã§ã„ã¾ã™ãŒã€ãƒˆãƒ¼ã‚¯ã®ä¸­ã§ã¯Kafka-9646ã®ä¸­ã§åˆã‚ã›ã¦èªã‚‰ã‚Œã¦ã„ã‚‹ã®ã§å‰²æ„›ã—ã¾ã—ãŸã€‚&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Exactly Onceã¨max.in.flightã«ã¤ã„ã¦</title><link>https://confluent-jp.github.io/community/blog/idempotent-producer-and-max-inflight/</link><pubDate>Mon, 03 Jul 2023 00:00:00 +0000</pubDate><guid>https://confluent-jp.github.io/community/blog/idempotent-producer-and-max-inflight/</guid><description>&lt;h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«&lt;/h2>
&lt;p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ç•Œéšˆã§ã®ãƒ‡ãƒªãƒãƒªãƒ¼ä¿è¨¼ã¯At Least Once (å¿…ãšé€ä¿¡ã™ã‚‹ãŒ1åº¦ä»¥ä¸Šé€ä¿¡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹) ã¨ã„ã†ã®ãŒå¸¸è­˜ã§ã‚ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚‹Consumerå´ã§å†ªç­‰æ€§ã‚’ä¿è¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ãã®Exactly Once SemantisãŒKafkaã§ã‚µãƒãƒ¼ãƒˆã•ã‚ŒãŸæ™‚ã«ã¯å¤šãã®åéŸ¿ã‚’å‘¼ã³ã¾ã—ãŸãŒã€ã“ã®è¨­å®šã¯æœ€è¿‘Defaultã§Onã«ãªã‚‹ç¨‹Kafkaã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã¯åºƒãåˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ãŸã ã“ã®ã‚¨ãƒ³ãƒãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆã«ã‚‚åˆ¶é™ãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã®åˆ¶é™ã¯å¾Œæ—¥ã€ã²ã£ãã‚Šã¨ä¸€ã¤ã®PRã«ã‚ˆã£ã¦è§£æ¶ˆã•ã‚Œã¦ã„ã¾ã™ã€‚è©±é¡Œã«ã¯ä¸Šã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€ã“ã®æ©Ÿèƒ½ãŒåºƒãåˆ©ç”¨ã•ã‚Œã‚‹ä¸Šã§ã¯éå¸¸ã«é‡è¦ãªã‚¨ãƒ³ãƒãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆã§ã—ãŸã€‚&lt;/p>
&lt;h2 id="exactly-once-semantics">Exactly Once Semantics&lt;/h2>
&lt;p>KafkaåˆæœŸã«ãŠã„ã¦æœ€ã‚‚æ³¨ç›®ã‚’é›†ã‚ãŸã‚¨ãƒ³ãƒãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆã®ä¸€ã¤ã«&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-98&amp;#43;-&amp;#43;Exactly&amp;#43;Once&amp;#43;Delivery&amp;#43;and&amp;#43;Transactional&amp;#43;Messaging" target="_blank" rel="noopener">KIP-98 - Exactly Once Delivery and Transactional Messaging&lt;/a> ãŒã‚ã‚Šã¾ã™ã€‚ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åŸºç›¤ã«ãŠã„ã¦Exactly Onceã¯ä¸å¯èƒ½ã€ã¨ã„ã†&lt;a href="https://ja.wikipedia.org/wiki/%E3%83%93%E3%82%B6%E3%83%B3%E3%83%81%E3%83%B3%E5%B0%86%E8%BB%8D%E5%95%8F%E9%A1%8C" target="_blank" rel="noopener">ãƒ“ã‚¶ãƒ³ãƒãƒ³å°†è»å•é¡Œ&lt;/a>è¦³ç‚¹ã‹ã‚‰ã®æ‡ç–‘çš„ãªæ„è¦‹ã‚‚å¤šãè­°è«–ã‚’å‘¼ã³ã¾ã—ãŸã€‚ãã‚‚ãã‚‚KafkaãŒå”±ãˆã‚‹Exactly Onceã®ã‚¹ã‚³ãƒ¼ãƒ—ã¯ä½•ã‹ã€ãã—ã¦ä½•ãŒãã®å‰æã¨ãªã£ã¦ã„ã‚‹ã®ã‹ã«ã¤ã„ã¦ã¯KafkaåˆæœŸé–‹ç™ºè€…ã§ã‚ã‚‹ãƒãƒã•ã‚“ã‚’å§‹ã‚ã¨ã—ã¦&lt;a href="https://www.confluent.io/blog/exactly-once-semantics-are-possible-heres-how-apache-kafka-does-it/" target="_blank" rel="noopener">å…·ä½“çš„ãªèª¬æ˜&lt;/a>ã‚‚ãŸãã•ã‚“ãªã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/p>
&lt;p>å®Ÿéš›ã®KIPã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹è¨­å®šæ¡ä»¶ã¯ä»¥ä¸‹ã§ã€ã“ã‚Œã‚‰ã‚‚åŒæ§˜ã«é©åˆ‡ã«è¨­å®šã—ãªã„é™ã‚Šã¯&lt;code>enable.idempotency=true&lt;/code>ã¨è¨­å®šã—ã¦ã‚‚Producerã®å†ªç­‰æ€§ã‚’ç¢ºä¿ã™ã‚‹ä¿è¨¼ã¯ãªã„ã¨è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ (ä»®ã«Idempotent Producerã¨ã—ã¦å‹•ã„ã¦PIDã«å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã¨ã—ã¦ã‚‚)ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ack&lt;/span>&lt;span class="o">=&lt;/span>all
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">retries &amp;gt; &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">max.inflight.requests.per.connection&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¿…ãšISRã¸ã®åŒæœŸãŒå®Œäº†ã—ã€ã‚¨ãƒ©ãƒ¼æ™‚ã«ã¯ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹æ§˜ã«ã—ã€ã‹ã¤Producerã‹ã‚‰ã®ä¸¦åˆ—é€ä¿¡ã¯è¨±å®¹ã—ãªã„ã€ã¨ã„ã†æ¡ä»¶ã§ã™ã€‚ç†ã«ã¯é©ã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;h2 id="kafka-5494">KAFKA-5494&lt;/h2>
&lt;p>&lt;a href="https://github.com/apache/kafka/pull/3743" target="_blank" rel="noopener">KAFKA-5494: enable idempotence with max.in.flight&amp;hellip;&lt;/a> ã“ã®PRã§ã¯KIP-98å®Ÿè£…ã«ãŠã‘ã‚‹èª²é¡Œã®èª¬æ˜ã¨ã€ãã‚Œã«å¯¾ã™ã‚‹è§£æ±ºç­–ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚å…·ä½“çš„ã«ã¯2ã¤ã®èª²é¡Œã¸ã®å¯¾å¿œãŒçºã¾ã£ãŸPRã¨ãªã£ã¦ãŠã‚Šã€çµæœã¨ã—ã¦max.in.flight.requests.per.connectionãŒ1ã§ã‚ã‚‹åˆ¶é™ã‚’æœ€å¤§5ã¾ã§å¢—ã‚„ã™å¯¾å¿œã¨ãªã£ã¦ã„ã¾ã™ã€‚&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>&lt;/p>
&lt;p>å¯¾å¿œã¨ã—ã¦ã®ãƒã‚¤ãƒ³ãƒˆã¯ã€Brokerã¨ã®é€šä¿¡é€”çµ¶æ™‚ã®Producerå´ (Client) ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ç•ªå·ã®æ¡ç•ªãƒ«ãƒ¼ãƒ«ã§ã™ã€‚é€ä¿¡ã‚¨ãƒ©ãƒ¼ã¨ãªã£ãŸå ´åˆã«ã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ç•ªå·ã‚’æ¡ç•ªã—ç›´ã™äº‹ã«ã‚ˆã‚Šå‡¦ç†ã‚’è‡ªå‹•å¾©æ—§ã™ã‚‹ã“ã¨ã€ã¾ãŸå†æ¡ç•ªã®å‰ã«é€ä¿¡å‡¦ç†ä¸­ã®ãƒãƒƒãƒãŒå…¨ã¦å‡¦ç†æ¸ˆã¿ã§ã‚ã‚‹ç¢ºèªç­‰ãŒè€ƒæ…®ã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>&lt;/p>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>KIPã§ã¯ãªãPRã¨ã—ã¦å®Ÿè£…ã•ã‚ŒãŸã“ã®å¤‰æ›´ã§ã™ãŒã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ä¾‹å¤–ãŒå‡ºãŸéš›ã«äº‹å¾Œå¾©æ—§å‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã‚‹äº‹ã€max.in.flightã‚’1ã‚ˆã‚Šå¤§ããæŒ‡å®šã§ãã‚‹äº‹ã€ã‚ˆã‚ŠåºƒãIdempotent Producerã‚’åˆ©ç”¨ã™ã‚‹ä¸Šã§é‡è¦ãªæ”¹å–„ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ãƒ‡ã‚¶ã‚¤ãƒ³è³‡æ–™ã¯&lt;a href="https://docs.google.com/document/d/11Jqy_GjUGtdXJK94XGsEIK7CP1SnQGdp2eF0wSw9ra8/" target="_blank" rel="noopener">ã“ã“&lt;/a>ã«ã‚ã‚Šã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>åˆã‚ã›ã¦&lt;code>OutOfSequenceException&lt;/code>ãŒç™ºç”Ÿã—ã¦ã—ã¾ã†ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®å¾Œç¶šå‡¦ç†ã¯å…¨ã¦åŒã˜ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹èª²é¡Œã«ã¤ã„ã¦ã‚‚å¯¾å¿œã•ã‚Œã¦ã„ã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>ã¾ãŸã“ã®PRã«é–¢ã™ã‚‹å‰ææƒ…å ±ã‚„è¨­è¨ˆã«ã¤ã„ã¦ã¯åˆ¥é€”&lt;a href="https://docs.google.com/document/d/1EBt5rDfsvpK6mAPOOWjxa9vY0hJ0s9Jx9Wpwciy0aVo/edit" target="_blank" rel="noopener">ã“ã¡ã‚‰&lt;/a>ã«ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Queues for Kafkaã¨ã¯ä½•ã‹?</title><link>https://confluent-jp.github.io/community/blog/kip923-queues-for-kafka/</link><pubDate>Fri, 30 Jun 2023 00:00:00 +0000</pubDate><guid>https://confluent-jp.github.io/community/blog/kip923-queues-for-kafka/</guid><description>&lt;h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«&lt;/h2>
&lt;p>Apache KafkaÂ® ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã¨æ¯”è¼ƒã•ã‚Œã‚‹äº‹ã‚‚å¤šãã€ã¾ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã¨ã—ã¦åˆ©ç”¨ã•ã‚Œã‚‹äº‹ã‚‚å¤šãã‚ã‚Šã¾ã™ã€‚&lt;a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-932%3A&amp;#43;Queues&amp;#43;for&amp;#43;Kafka" target="_blank" rel="noopener">KIP-932 Queues for Kafka&lt;/a> ã¯ãã®Kafkaã«å¯¾ã—ã¦ãƒã‚¤ãƒ†ã‚£ãƒ–ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹æ©Ÿèƒ½æ€§ã‚’è¿½åŠ ã™ã‚‹KIPã§ã™ã€‚&lt;/p>
&lt;h2 id="consumer-group">Consumer Group&lt;/h2>
&lt;p>Kafkaã¯ä»•çµ„ã¿çš„ã«ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã§ã¯ãªã„ã€ã¨è¨€ã†ã®ã¯èªå¼ŠãŒã‚ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚ã‚‚ã†å°‘ã—æ­£ç¢ºã«èª¬æ˜ã™ã‚‹ã¨ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é †åºä¿è¨¼ (Order Guarantee) ã‚’ç¢ºä¿ã™ã‚‹ç‚ºã«ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹éš›ã«åˆ¶é™ãŒã‚ã‚‹ã€ä»•çµ„ã¿ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®ä»•çµ„ã¿ã¯Consumer Groupã¨å‘¼ã°ã‚Œã€Kafkaã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ã®åˆ†é›¢å˜ä½ã§ã‚ã‚‹Partitionå˜ä½ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é †åºä¿è¨¼ã‚’ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã™ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.confluent.io/blog/dynamic-vs-static-kafka-consumer-rebalancing/" target="_blank" rel="noopener">Consumer Group&lt;/a>ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»»æ„ã«æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã€ãã®ç®¡ç†ã¯Kafka Brokerã«ã¦ç¨¼åƒã™ã‚‹Consumer Group Coordinatorã¨ã„ã†ãƒ—ãƒ­ã‚»ã‚¹ãŒè¡Œã„ã¾ã™ã€‚Consumer Group Coordinatorã¯Groupãƒ¡ãƒ³ãƒãƒ¼ã®è¿½åŠ /å‰Šé™¤ã®è‡ªå‹•æ¤œçŸ¥ã¨ãƒªãƒãƒ©ãƒ³ã‚¹ã‚’æ‹…å½“ã—ã€Consumer Groupãƒ¡ãƒ³ãƒãƒ¼ã®è¿½åŠ /é›¢è„±ã‚„ã“ã‚Œã‚‰ã®æ­»æ´»ç›£è¦–ã€ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ãŸå‡¦ç†ã®ãƒªãƒãƒ©ãƒ³ã‚¹ (ãƒ¡ãƒ³ãƒãƒ¼ã¸ã®Partitionã®ãƒªã‚¢ã‚µã‚¤ãƒ³) ã‚’è‡ªå‹•çš„ã«è¡Œã„ã¾ã™ã€‚Consumer Groupã®ä»•çµ„ã¿ã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å¯ç”¨æ€§ã¨æ‹¡å¼µæ€§ã«é‡è¦ãªå½¹å‰²ã‚’æ‹…ã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ä¸€æ–¹ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ã®é †åºä¿è¨¼ã‚’å‰æã¨ã—ã¦ã„ã‚‹ç‚ºã€ Partitionã«è¤‡æ•°ã®Consumerã‚’è¨­å®šã™ã‚‹äº‹ãŒå‡ºæ¥ãšã€ã“ã®ç‚ºTopicã«æŒ‡å®šã™ã‚‹Partitionæ•°ãŒä¸¦åˆ—å‡¦ç†èƒ½åŠ›ã®æ‹¡å¼µæ€§ã‚’æ±ºå®šã—ã¾ã™ã€‚ ã¾ãŸã€ãã‚‚ãã‚‚é †åºæ€§ã®ä¿è¨¼ãŒä¸è¦ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã‚ã£ã¦ã‚‚Consumer Groupã®ãƒ«ãƒ¼ãƒ«ã«å‰‡ã‚‰ãªã„ã¨ã„ã‘ãªã„ã¨ã„ã†åˆ¶ç´„ã¯å­˜åœ¨ã—ã¾ã™ã€‚å¤§å®¹é‡ã®ãƒ‡ãƒ¼ã‚¿å‡¦ç† and/or éå¸¸ã«æŸ”è»Ÿãªæ‹¡å¼µæ€§ã®åˆ¶å¾¡ãŒè¦æ±‚ã•ã‚Œã‚‹ã‚ˆã†ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯èª²é¡Œã¨ãªã‚Šå¾—ã‚‹ã€ã¨ã„ã†ã‚ˆã‚Šæ­¯ç—’ã„æ¡ä»¶ã¨è¦‹ã‚‰ã‚Œã‚‹äº‹ã‚‚ã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;h2 id="ã“ã‚Œã¾ã§ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ">ã“ã‚Œã¾ã§ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ&lt;/h2>
&lt;p>ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯6ã€10ã€12ã¨ã„ã£ãŸãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«æ²¿ã£ãŸPartitionæ•°ã‚’æŒ‡å®šã™ã‚‹äº‹ã«ã‚ˆã‚Šã€å……åˆ†ãªä¸¦åˆ—å‡¦ç†èƒ½åŠ›ã¨æ‹¡å¼µæ€§ã‚’ç¢ºä¿ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ä»®ã«ã©ã‚Œã ã‘ã®ä¸¦åˆ—å‡¦ç†èƒ½åŠ›ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã¨ã—ã¦ã‚‚ã€å°†æ¥çš„ã«ã‚‚1å‡¦ç†ã«å¯¾ã—ã¦24ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚ˆã‚‹ä¸¦åˆ—å‡¦ç†ãŒå¿…è¦ã¨ãªã‚‹äº‹ãŒç„¡ã„ã®ã§ã‚ã‚Œã°ã€Partitionæ•°ã‚’24ã¨ã—ã¦ãŠã‘ã°å®‰å…¨åœã§ã™ã€‚ä¸€èˆ¬çš„ã«ã¯ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¤šãå–ã‚‰ã‚Œã¾ã™ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/line/decaton" target="_blank" rel="noopener">LINE Decaton&lt;/a> ã¯LINE CorporationãŒç¤¾å†…åˆ©ç”¨ã®ç‚ºã«é–‹ç™ºã—ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹åŒ–ã—ãŸKafkaãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚å¤§å®¹é‡ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†ã‚’å®‰å®šçš„ã«ã€ã‹ã¤Keyå˜ä½ã®é †åºä¿è¨¼ã¨At Least Onceã®ãƒ‡ãƒªãƒãƒªã‚’ä¿è¨¼ã™ã‚‹äº‹ãŒå¯èƒ½ã§ã™ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/confluentinc/parallel-consumer" target="_blank" rel="noopener">Confluent Parallel Consumer&lt;/a> ã¯ConfluentãŒã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã§æä¾›ã—ã¦ã„ã‚‹åˆ†æ•£å‡¦ç†Kafkaãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ã“ã¡ã‚‰ã‚‚Keyå˜ä½ã§ã®é †åºä¿è¨¼ã‚’ã—ã¦ãŠã‚Šã€&lt;a href="https://www.confluent.io/blog/introducing-confluent-parallel-message-processing-client/" target="_blank" rel="noopener">é †åºä¿è¨¼ã—ãªã„è¨­å®šã‚’å«ã‚æŸ”è»Ÿã«å‡¦ç†æ§‹æˆã‚’å¤‰æ›´&lt;/a>ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚&lt;/p>
&lt;h2 id="queue-for-kafka---kafka-nativeãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒ">Queue for Kafka - Kafka Nativeãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒ&lt;/h2>
&lt;p>Queues for Kafkaã¯Consumer Groupã¨ç•°ãªã‚‹æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã™ã€‚Share Groupã¨å‘¼ã°ã‚Œã€Partitionæ•°ã«å½±éŸ¿ãªããƒ¡ãƒ³ãƒãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚&lt;/p>
&lt;p>Shared Groupã¯å…¨ãç•°ãªã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã¯ãªãã€ã“ã‚Œã¾ã§ã®Consumer Groupã¨åŒåˆ—ã«æ‰±ã‚ã‚Œã€&lt;code>group.type&lt;/code>ã‚’&lt;code>share&lt;/code>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ã¨è¨­å®šã™ã‚‹äº‹ã«ã‚ˆã£ã¦æŒ‡å®šã—ã¾ã™ã€‚Consumer Groupã®å ´åˆã€Partitionæ•°ã‚’è¶…ãˆã‚‹ãƒ¡ãƒ³ãƒãƒ¼ã‚’æŒ‡å®šã—ã¦ã‚‚å‡¦ç†ã«å‚åŠ ã§ããªã‹ã£ãŸã‚Šã€Partitionæ•°ã‚’ãã£ã¡ã‚Šå‰²ã‚Šåˆ‡ã‚Œã‚‹ãƒ¡ãƒ³ãƒãƒ¼æ•°ã§ãªã„ã¨ã‚¢ã‚µã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã«åã‚ŠãŒå‡ºã¾ã™ãŒã€Share Groupã®å ´åˆã¯ä»»æ„ã®ãƒ¡ãƒ³ãƒãƒ¼æ•°ã‚’æŒ‡å®šã™ã‚‹äº‹ã«ã‚ˆã‚Šå‡ä¸€ã‹ã¤æ°´å¹³ã«ã‚¹ã‚±ãƒ¼ãƒ«ã—ã¾ã™ã€‚&lt;/p>
&lt;p>Consumer Groupã¨æ§‹æˆã‚‚åŒã˜ã§ã€Brokerã®ã†ã¡Consumer Group Coorinatorã§ã¯ãªãShare Group Coordinatorã‚’å¸ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã®æ­»æ´»ç›£è¦–ã€ãƒªãƒãƒ©ãƒ³ã‚¹ç­‰ã‚’Consumer GroupåŒæ§˜ã«å®Ÿæ–½ã—ã¾ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¦³ç‚¹ã§ã‚‚ãƒ‡ãƒ—ãƒ­ã‚¤è¦³ç‚¹ã§ã‚‚ã€Consuemr Groupã¨ã®å·®ã¯ãªãã€ã‚ãã¾ã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¨­å®šã™ã‚‹ã®ã¿ã§ã‚°ãƒ«ãƒ¼ãƒ—ã®æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚&lt;/p>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>Kafkaã¨ã„ã†ã¯ãã®ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­è¨ˆã‚†ãˆã«ã€ååˆ†ç†è§£ã—ãªã„ã¨æ´»ç”¨ãŒé›£ã—ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã—ãŸã€‚ãŸã ã“ã®ã‚·ãƒ³ãƒ—ãƒ«ã•ã«ã‚ˆã£ã¦ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã¨ã‚ã‚‰ã‚†ã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã®æ´»ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã€Kafkaã®ç†è§£ã‚’æ·±ã‚ã‚‹äº‹ã¯ã‚ˆã‚Šè‰¯ã„è¨­è¨ˆã‚’ã™ã‚‹ä¸Šã§éå¸¸ã«é‡è¦ã§ã™ã€‚KIP-932ã¯ã€Kafkaèª•ç”Ÿã‹ã‚‰å¤‰ã‚ã‚‹ã“ã¨ã®ç„¡ã‹ã£ãŸConsumer Groupã¨ã„ã†ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã¯ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã™ã‚‹å¤‰æ›´ã¨ã„ã†æ„å‘³ã§ã¯éå¸¸ã«èˆˆå‘³æ·±ã„KIPã§ã™ã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;code>group.type&lt;/code>ã¯æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯&lt;code>consumer&lt;/code>ã§ã‚ã‚Šã€ã“ã®æŒ‡å®šã ã¨é€šå¸¸é€šã‚ŠConsumer Groupã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯&lt;code>consumer&lt;/code>ã§ã‚ã‚‹ç‚ºä¸‹ä½äº’æ›æ€§ã‚ã‚Šã€‚&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item></channel></rss>